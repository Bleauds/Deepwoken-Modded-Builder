<!DOCTYPE html>
<html lang="en">
   <!-- Mirrored from deepwoken.co/builder by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 23 Mar 2025 18:01:47 GMT -->
   <head>
      <html lang="en" style="--button-background: #5c001c; --background: radial-gradient(#5c001c, #400114);">
         <head>
   </head>
   <meta charset="utf-8" />
   <link rel="icon" href="favicon.png" />
   <meta name="viewport" content="width=device-width, initial-scale=1.0" />
   <!-- Primary Meta Tags -->
   <meta name="title" content="Deepwoken Builder" />
   <meta
      name="description"
      content="Deepwoken stats builder, with full talents and mantra support. Available for all devices! Made by Cyfiee"
      />
   <!-- Open Graph / Facebook -->
   <meta property="og:type" content="website" />
   <meta property="og:url" content="https://discord.gg/vMBHH8BkDC" />
   <meta property="og:title" content="Home - Deepwoken Modded" />
   <meta
      property="og:description"
      content="Deepwoken stats builder, with full talents and mantra support. Available for all devices! Made by Cyfiee"
      />
   <meta
      property="og:image"
      content="../cdn.discordapp.com/attachments/854957876313063447/1199965058848018462/dark-favicon.png"
      />
   <!--<script src="https://hb.vntsm.com/v4/live/vms/sites/deepwoken.co/index.js"></script>
      <script>
      self.__VM = self.__VM || [];
      self.__VM.push(function (admanager, scope) {
        scope.Config.get('billboard').display('slot-1');
         scope.Config.get('desktop_takeover').display('slot-2');
         scope.Config.get('leaderboard').display('slot-3');
         scope.Config.get('mobile_banner').display('slot-4');
         scope.Config.get('mobile_mpu').display('slot-5');
         scope.Config.get('mobile_takeover').display('slot-6');
         scope.Config.get('mpu').display('slot-7');
       // Based on your layout, here are the responsive tags. The placement will change based on screen width.
       // With the mobile breakpoint set by default at max-width:1024px
      });-->

   </script>
   <!-- Ad tag -->
   <script type="text/javascript">
      window.ramp = window.ramp || {};
      window.ramp.que = window.ramp.que || [];
      window.ramp.passiveMode = true;
   </script>
   <script>
      window.pwUnits = [
      	{
      		selectorId: 'first-med-rect',
      		type: 'med_rect_atf'
      	},
      	{
      		type: 'bottom_rail'
      	},
      	{
      		type: 'left_rail'
      	},
      	{
      		type: 'right_rail'
      	},
      	{
      		type: 'corner_ad_video'
      	}
      ];
      var init = function () {
      	ramp
      		// pass in the array where you defined the units
      		.addUnits(window.pwUnits)
      		.then(() => {
      			// then show the units
      			ramp.displayUnits();
      		})
      		.catch((e) => {
      			// catch errors
      			ramp.displayUnits();
      			console.log(e);
      		});
      };
      ramp.onReady = function () {
      	console.log('Ads API is initialized');
      	init();
      };
      let previousUrl = location.href;
      const observer = new MutationObserver(function(mutations) {
      if (location.href !== previousUrl) {
      	previousUrl = location.href;
      	console.log(ramp)
      	ramp
      				.destroyUnits('all')
      				.then(() => {
      					// pass in the array 'pwUnits'
      					ramp.addUnits(window.pwUnits).then(() => {
      						ramp.displayUnits();
      
      						console.log('units displayed upon navigation');
      					});
      				})
      				.catch((e) => {
      					// catch errors
      
      					ramp.displayUnits();
      
      					console.log(e);
      				});
      		}
      });
      const config = {subtree: true, childList: true};
      observer.observe(document, config);
   </script>
   <script type="text/javascript" async="true" src="../cdn.intergient.com/1025149/74714/ramp.html"></script>
   <link href="_app/immutable/assets/0.DD9ggIW9.css" rel="stylesheet">
   <link href="_app/immutable/assets/Icon.B_4K0AlN.css" rel="stylesheet">
   <link href="_app/immutable/assets/4.SrwoI1B3.css" rel="stylesheet">
   <link href="_app/immutable/assets/BuildMenu.CDysIOrQ.css" rel="stylesheet"><title> Deepwoken Builder </title><!-- HEAD_svelte-ymnxwf_START --><meta name="title" content="Deepwoken Modded Builder"><meta name="description" content="Deepwoken Modded stats builder, with full talents and mantra support. Available for all devices! Made by Cyfer#2380"><meta property="og:type" content="website"><meta property="og:url" content="https://discord.gg/vMBHH8BkDC"><meta property="og:title" content="Deepwoken Builder"><meta property="og:description" content="Deepwoken stats builder, with full talents and mantra support. Available for all devices! Made by Cyfer#2380"><meta property="og:image" content="https://cdn.discordapp.com/attachments/854957876313063447/1199965058848018462/dark-favicon.png"><meta property="twitter:url" content="https://discord.gg/vMBHH8BkDC"><meta property="twitter:title" content="Deepwoken Builder"><meta property="twitter:description" content="Deepwoken stats builder, with full talents and mantra support. Available for all devices! Made by Cyfer#2380"><meta property="twitter:image" content="https://cdn.discordapp.com/attachments/854957876313063447/1199965058848018462/dark-favicon.png"><meta name="keywords" content="deepwoken, roblox, deepwoken roblox, deepwoken builder, builder, dw builder, dw, deepwoken stat builder, stat builder, build maker, dw build maker, deepwoken build maker, build maker deepwoken, dw build, deepwoken vercel"><meta name="author" content="Cyfer"><meta name="description" content="Deepwoken stats builder, with full talents and mantra support. Available for all devices! Made by Bleaud"><!-- HEAD_svelte-ymnxwf_END -->
   </head>
   <!-- Google tag (gtag.js) -->
   <script>
      window._pwGA4PageviewId = ''.concat(Date.now());
      window.dataLayer = window.dataLayer || [];
      window.gtag =
      	window.gtag ||
      	function () {
      		dataLayer.push(arguments);
      	};
      gtag('js', new Date());
      gtag('config', 'G-LVL3Z5R4QP', { send_page_view: false });
      gtag('config', 'G-00M516D817');
      gtag('event', 'ramp_js', {
      	send_to: 'G-LVL3Z5R4QP',
      	pageview_id: window._pwGA4PageviewId
      });
   </script>
   <script async src="https://www.googletagmanager.com/gtag/js?id=G-00M516D817"></script>

   <!-- paste  below-->
   <body data-sveltekit-preload-data="hover">
	<script>
	   var global = global || window
	   window.dataLayer = window.dataLayer || [];
	</script>
<div style="display: contents">
	<meta charset="utf-8">
	<link rel="preconnect" href="https://fonts.googleapis.com/">
	<link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="">
	<link href="https://fonts.googleapis.com/css2?family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&amp;display=swap" rel="stylesheet">
	<script>var global = global || window;
	   //
	   window.dataLayer = window.dataLayer || [];
	   function gtag() {
		dataLayer.push(arguments);
	   }
	   gtag('js', new Date());
	   
	   gtag('config', 'G-00M516D817');
	</script> 
	<style lang="scss">
	   :root {
	   --button-background: #04100d;
	   --background: radial-gradient(#18221a, #04100d);
	   --color: white;
	   --container-background: rgba(216, 215, 202, 1);
	   }
	   body {
	   display: flex;
	   align-items: center;
	   flex-direction: column;
	   padding: 60px;
	   background: var(--background);
	   min-height: 600px;
	   font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
	   overflow-x: hidden;
	   }
	   .black-silence {
	   background: #171717 !important;
	   color: white !important;
	   }
	   /* Festive stuff! 
	   .festive-grid-item {
	   border: 5px solid transparent !important;
	   border-image: url(/borderthin-festive.png) 25% repeat !important;
	   border-image-width: 5px !important;
	   background: white;
	   }
	   .festive-builder-container {
	   border: 5px solid transparent !important;
	   border-image: url(/border-festive.png) 25% repeat !important;
	   border-image-width: 10px !important;
	   }
	   .festive {
	   background: radial-gradient(#820016, #45000c);
	   }
	   .snow-container {
	   position: fixed;
	   top: 0;
	   left: 0;
	   overflow: hidden;
	   width: 100vw;
	   height: 100vh;
	   z-index: 99999;
	   pointer-events: none;
	   }
	   .snowflake {
	   position: absolute !important;
	   background-color: white;
	   border-radius: 50%;
	   opacity: 0.8;
	   pointer-events: none;
	   }
	   @keyframes fall {
	   0% {
	   opacity: 0;
	   transform: translateY(0);
	   }
	   10% {
	   opacity: 1;
	   }
	   100% {
	   opacity: 0.5;
	   transform: translateY(100vh);
	   }
	   }
	   @keyframes diagonal-fall {
	   0% {
	   opacity: 0;
	   transform: translate(0, 0);
	   }
	   10% {
	   opacity: 1;
	   }
	   100% {
	   opacity: 0.25;
	   transform: translate(10vw, 100vh);
	   }
	   }*/
	   .fixed {
	   position: fixed;
	   color: white;
	   border: 1px solid transparent;
	   border-image: url(border.png) 45%;
	   border-image-width: 15px;
	   border-image-outset: 2px;
	   padding: 5px;
	   }
	   /* */
	   .toggle-desktop {
	   margin: 5px;
	   color: #202020;
	   border: 1px solid transparent;
	   border-image: url(border.png) 45%;
	   border-image-width: 15px;
	   border-image-outset: 2px;
	   padding: 5px;
	   font-size: 14px;
	   background-color: hsl(56, 16%, 82%);
	   }
	   /* */
	   .footer {
	   font-family: 'Lora', 'sans-serif';
	   font-size: 12px;
	   padding: 5px;
	   }
	   .selected {
	   color: white !important;
	   background-color: #1a1a1a !important;
	   }
	   /* Loading */
	   .loading {
	   display: none;
	   }
	   #footer-ad {
	   width: 100%;
	   }
	   #first-med-rect {
	   display: none;
	   }
	   @media only screen and (max-width: 600px) {
	   #first-med-rect {
	   display: block;
	   }
	   }
	   ._toastItem {
	   border-image: url(borderthin.png) 45% !important;
	   border-image-width: 10px !important;
	   border-image-outset: 2px !important;
	   background: hsl(56, 16%, 82%) !important;
	   color: black !important;
	   }
	   input:disabled,
	   select:disabled {
	   cursor: not-allowed;
	   }
	   .tabs-container {
    position: relative; /* Acts as the positioning context for absolute children */
    width: 100%;
    height: auto; /* Allow height to adjust dynamically */
    overflow: hidden; /* Prevent overflow issues */
}

#Stats, #Talents {
    position: absolute; /* Stack them as layers */
    top: 0;
    left: 0;
    width: 100%; /* Full width of the parent container */
    height: auto; /* Allow height to adjust to content */
    transition: opacity 0.3s ease; /* Smooth transition for opacity */
}

#Stats {
    visibility: visible; /* Show Stats by default */
    opacity: 1;
    pointer-events: auto;
}

#Talents {
    visibility: hidden; /* Hide Talents by default */
    opacity: 0;
    pointer-events: none;
}

.tabs-button.selected {
    border-bottom: 2px solid #ffffff; /* Highlight the active tab */
    font-weight: bold;
}

/* Ensure the parent container adjusts to the tallest child */
.builder-container {
    position: relative;
    display: flex;
    flex-direction: column;
}
</style>
<div class="navbar border">
   <div class="logo">
	  <button id="navbutton" class="nav-button border-thin" data-svelte-h="svelte-131a9vx"><img src="menu.png" alt="nav menu" style="max-height: 100%;"></button> 
	  <a style="display: flex; align-items: center; color: white; font-size: 15px; margin-left: 10px; text-decoration: none"data-svelte-h="svelte-4d1lng">
		 <img src="favicon.png" alt="icon" style="max-width: 25px; margin-right: 5px;"> 
		 <p>Deepwoken Modded Hub</p>
	  </a>
   </div>
   <div id="profile">
	  <p id="profileName" style="margin-right: 15px">By Bleaud</p>
	  <div id="profilePictureContainer" style="width: 25px; height: 25px" class="svelte-142ncmc">
		 <button id="profilePictureButton" class="svelte-142ncmc"><img id="profilePicture" style="pointer-events: none" src="discord.png" alt="discord" class="svelte-142ncmc"></button> 
		 <div class="login-button border-thin svelte-142ncmc"></div>
	  </div>
   </div>
</div>
<div id="first-med-rect"></div>
<div class="error-container border" style="display: none" data-svelte-h="svelte-1adslop">
   <h1 style="text-align: center">Maintenence</h1>
   Cyfer is currently working on changes to the website. In the meantime, you can join the<a href="https://discord.gg/vMBHH8BkDC" target="_blank">Discord</a> to stay up to date about the site's availability!.
</div>
<div class="builder-container" id="builder-container" style="max-width: 475px; width: 90vw;">
   <div class="build-info border show">
	  <div class="author-container">
		 <div class="author">
			<div id="profilePictureContainer" style="width: 30px; height: 30px" class="svelte-142ncmc">
			   <button id="profilePictureButton" class="svelte-142ncmc"><img id="profilePicture" style="pointer-events: none" src="discord.png" alt="discord" class="svelte-142ncmc"></button> 
			   <div class="login-button border-thin svelte-142ncmc"></div>
			</div>
			<div class="author-name" data-svelte-h="svelte-by65n7">
			   <div>Anonymous</div>
			</div>
		 </div>
		 <div class="menu-wrapper">
			<div class="menu-container svelte-18h6jo9"><button class="p-1 rounded hover:bg-black/5 transition-colors svelte-18h6jo9"></button>  </div>
		 </div>
	  </div>
	  <input id="build-name" class="input title" placeholder="Build name">  
	  <div id="tags">  </div>
	  <div contenteditable="true" id="build-description" class="input description show" placeholder="Build description"></div>
   </div>
   <div class="tabs border">
	  <div class="social-buttons"> </div>
	  <div style="display: none" class="svelte-2e1jrf"><input id="buildLink" readonly="" value="https://deepwoken.co/builder?id=XXXXXXXX" class="svelte-2e1jrf">  <button class="export-link svelte-2e1jrf"> Get Link</button> </div>
	  <div class="tabs-buttons border"> <button class="tabs-button border-thin">Stats</button><button class="tabs-button border-thin">Talents</button></div>
   </div>
   <div class="tabs-container border">
<div class="container svelte-hwcpcr" id="Talents" role="button" tabindex="0" style="display: grid; visibility: visible; opacity: 1; pointer-events: auto;">
    <div class="grid-item rollable-talents svelte-hwcpcr" id="rollable-talent-1">
        <div style="text-align: center" class="svelte-hwcpcr"><b class="svelte-hwcpcr" data-svelte-h="svelte-148zqj2">Obtainable Talents</b> <i style="color: gray" class="svelte-hwcpcr">43</i></div>
        <div style="display: flex; justify-content: space-around" class="svelte-hwcpcr"><b class=" svelte-hwcpcr">9</b> <b class="Rare svelte-hwcpcr">7</b> <b class="Advanced svelte-hwcpcr">0</b></div> <input type="text" placeholder="Search talents..." aria-autocomplete="none" class="svelte-hwcpcr"> <button class="filters-display off svelte-hwcpcr" data-svelte-h="svelte-118qp2v">Filters</button>
        <div class="filters svelte-hwcpcr" style="display: none"><button class="filter pre false svelte-hwcpcr" tabindex="0">PRE <img class="icon svelte-hwcpcr" title="This talent is only obtainable pre-shrine." width="14" height="14" alt="new" src="/shrineicon.png" style="margin-left: 3px"> </button><button class="filter post false svelte-hwcpcr" tabindex="0">POST </button><button class="filter fav false svelte-hwcpcr" tabindex="0">FAV <img class="icon svelte-hwcpcr" title="This talent was favorited by the build's creator!" width="14" height="14" alt="new" src="/lovedicon.png" style="margin-left: 3px"> </button><button class="filter str false svelte-hwcpcr" tabindex="0">STR </button><button class="filter agi false svelte-hwcpcr" tabindex="0">AGI </button><button class="filter ftd false svelte-hwcpcr" tabindex="0">FTD </button><button class="filter int false svelte-hwcpcr" tabindex="0">INT </button><button class="filter wil false svelte-hwcpcr" tabindex="0">WIL </button><button class="filter cha false svelte-hwcpcr" tabindex="0">CHA </button><button class="filter attunement false svelte-hwcpcr" tabindex="0">ATTUNEMENT </button></div>
        <div id="Advanced-dropdown-button" active="true" class="Advanced rarity svelte-hwcpcr" role="button" tabindex="0">
			<b class="svelte-hwcpcr">Advanced</b>
			<div style="color:white" id="Advanced-dropdown-icon" class="svelte-hwcpcr">▾</div>
		</div>
		<div id="Advanced-dropdown" class="talents-container svelte-hwcpcr">
			<div class="talent svelte-hwcpcr" data-svelte-h="svelte-1yuze5x">No talents :(</div>
		</div>
		
		<div id="Rare-dropdown-button" active="true" class="Rare rarity svelte-hwcpcr" role="button" tabindex="0">
			<b class="svelte-hwcpcr">Rare</b>
			<div style="color:white" id="Rare-dropdown-icon" class="svelte-hwcpcr">▾</div>
		</div>
		<div id="Rare-dropdown" class="talents-container svelte-hwcpcr">
			<div class="talent svelte-hwcpcr" data-svelte-h="svelte-1yuze5x">No talents :(</div>
		</div>
		
		<div id="Common-dropdown-button" active="true" class="Common rarity svelte-hwcpcr" role="button" tabindex="0">
			<b class="svelte-hwcpcr">Common</b>
			<div style="color:white" id="Common-dropdown-icon" class="svelte-hwcpcr">▾</div>
		</div>
		<div id="Common-dropdown" class="talents-container svelte-hwcpcr">
			<div class="talent svelte-hwcpcr" data-svelte-h="svelte-1yuze5x">No talents :(</div>
		</div>
		<script>
			document.addEventListener('DOMContentLoaded', function () {
				// Stats mapping from the export script
				const statsMapping = {
					st: 'Strength',
					pe: 'Precision',
					fo: 'Fortitude',
					ag: 'Agility',
					in: 'Intelligence',
					wi: 'Willpower',
					ch: 'Charisma',
					he: 'Heavy Wep.',
					me: 'Medium Wep.',
					li: 'Light Wep.',
					fl: 'Flamecharm',
					fr: 'Frostdraw',
					th: 'Thundercall',
					ga: 'Galebreathe',
					sh: 'Shadowcast',
					ir: 'Ironsing',
					bl: 'Bloodrend',
					eb: 'Earthbend',
					ra: 'Race',
					oa: 'Oath',
					mu: 'Murmur',
					be: 'Bell'
				};
		
				// Map shorthand keys to Lua-style Total[Stat] keys
				const luaStatsMapping = {
					st: 'TotalStrength',
					pe: 'TotalPrecision',
					fo: 'TotalFortitude',
					ag: 'TotalAgility',
					in: 'TotalIntelligence',
					wi: 'TotalWillpower',
					ch: 'TotalCharisma',
					fl: 'TotalElementFire',
					fr: 'TotalElementIce',
					th: 'TotalElementLightning',
					ga: 'TotalElementWind',
					sh: 'TotalElementShadow',
					ir: 'TotalElementIron',
					bl: 'TotalElementBlood',
					eb: 'TotalElementEarth'
					// Add more mappings if needed (e.g., for Level, Mantras)
				};
		
				// Function to collect and update player stats
				function updatePlayerStats() {
					const stats = {};
					Object.keys(statsMapping).forEach(key => {
						const input = document.querySelector(`input[statname="${statsMapping[key]}"]`);
						const select = document.querySelector(`select[statname="${statsMapping[key]}"]`);
		
						if (input) {
							stats[key] = parseInt(input.value) || 0;
						} else if (select) {
							stats[key] = select.value || 0;
						} else {
							stats[key] = 0; // Default to 0 if no input or select found
						}
					});
		
					const playerStats = {};
					Object.keys(stats).forEach(key => {
						if (luaStatsMapping[key]) {
							playerStats[luaStatsMapping[key]] = stats[key];
						}
					});
		
					// Add Level and Mantras (if available on the page)
					const levelInput = document.querySelector('input[statname="Level"]');
					playerStats.Level = levelInput ? parseInt(levelInput.value) || 0 : 0;
		
					const mantrasInput = document.querySelector('input[statname="Mantras"]') || document.querySelector('select[statname="Mantras"]');
					playerStats.Mantras = mantrasInput ? mantrasInput.value : "";
		
					return playerStats;
				}
		
				// Simulated current talents (replace with actual selected talents, e.g., from a store)
				let currentTalents = {
					"Risky Moves": true,
				};
		
				// Fetch the JSON file and populate initially
				fetch('talents.json')
					.then(response => response.json())
					.then(data => {
						const playerStats = updatePlayerStats();
						populateDropdowns(data.TalentsInfo, currentTalents, playerStats);
						populateObtainedTalents(currentTalents, data.TalentsInfo);
		
						// Add event listeners to update talents when stats change
						Object.values(statsMapping).forEach(statName => {
							const input = document.querySelector(`input[statname="${statName}"]`);
							const select = document.querySelector(`select[statname="${statName}"]`);
							if (input) {
								input.addEventListener('input', () => {
									const updatedStats = updatePlayerStats();
									populateDropdowns(data.TalentsInfo, currentTalents, updatedStats);
								});
							} else if (select) {
								select.addEventListener('change', () => {
									const updatedStats = updatePlayerStats();
									populateDropdowns(data.TalentsInfo, currentTalents, updatedStats);
								});
							}
						});
		
						// Add event listener for Level and Mantras if they exist
						const levelInput = document.querySelector('input[statname="Level"]');
						if (levelInput) {
							levelInput.addEventListener('input', () => {
								const updatedStats = updatePlayerStats();
								populateDropdowns(data.TalentsInfo, currentTalents, updatedStats);
							});
						}
						const mantrasInput = document.querySelector('input[statname="Mantras"]') || document.querySelector('select[statname="Mantras"]');
						if (mantrasInput) {
							mantrasInput.addEventListener('input', () => {
								const updatedStats = updatePlayerStats();
								populateDropdowns(data.TalentsInfo, currentTalents, updatedStats);
							});
							if (mantrasInput.tagName === 'SELECT') {
								mantrasInput.addEventListener('change', () => {
									const updatedStats = updatePlayerStats();
									populateDropdowns(data.TalentsInfo, currentTalents, updatedStats);
								});
							}
						}
					})
					.catch(error => console.error('Error loading talents:', error));
		
				function populateDropdowns(talents, currentTalents, playerStats) {
					// Group talents by rarity and class
					const groupedTalents = {
						Advanced: {},
						Rare: {},
						Common: {}
					};
		
					// Helper function to check if a mantra exists
					function hasMantra(mantras, mantraName) {
						return mantras && typeof mantras === 'string' ? mantras.includes(mantraName) : false;
					}
		
					// Filter and group talents based on requirements
					// Only enforce "must have" prerequisites and stat/mantra requirements
					// Ignore "cannot have" conditions
					for (const [talentName, talentData] of Object.entries(talents)) {
						let isEligible = true;
		
						// Apply Lua logic to determine eligibility
						if (talentName === "Ghost" && !currentTalents["Risky Moves"]) {
							isEligible = false;
						} else if (talentName === "Scatter" && !currentTalents["Electrocution"]) {
							isEligible = false;
						} else if (talentName === "Emperor Flame" && !currentTalents["The Final Act"]) {
							isEligible = false;
						} else if (talentName === "Short Circuit" && !currentTalents["Electrocution"]) {
							isEligible = false;
						} else if (talentName === "Decaying Posture" && !currentTalents["Decay Path: Oxidize"]) {
							isEligible = false;
						} else if (talentName === "Oxidizing Blitz" && !currentTalents["Decay Path: Oxidize"]) {
							isEligible = false;
						} else if (talentName === "Unipolar Conductivity" && !currentTalents["Unipolar Path: Teslafication"]) {
							isEligible = false;
						} else if (talentName === "Melted Wire" && !currentTalents["Unipolar Path: Teslafication"]) {
							isEligible = false;
						} else if (talentName === "Raiton's Charge" && !currentTalents["Raiton Path: Enlightened"]) {
							isEligible = false;
						} else if (talentName === "Overcharge" && !currentTalents["Unipolar Path: Teslafication"]) {
							isEligible = false;
						} else if (talentName === "Molten Defense" && !currentTalents["Eruption Path: Lava Serpent"]) {
							isEligible = false;
						} else if (talentName === "Flash Point" && !currentTalents["Eruption Path: Lava Serpent"]) {
							isEligible = false;
						} else if (talentName === "The Floor is Lava" && !currentTalents["Eruption Path: Lava Serpent"]) {
							isEligible = false;
						} else if (talentName === "Double Trouble" && !currentTalents["Eruption Path: Lava Serpent"]) {
							isEligible = false;
						} else if (talentName === "Tough Love" && !currentTalents["Charismatic Cast"]) {
							isEligible = false;
						} else if (talentName === "Magical Resolve" && !currentTalents["Battle Tendency"]) {
							isEligible = false;
						} else if (talentName === "Turtle Shell" && !currentTalents["Knight's Rally"]) {
							isEligible = false;
						} else if (talentName === "Maiming Claws" && !currentTalents["Down Comes the Claw"]) {
							isEligible = false;
						} else if (talentName === "Crystal Shrapnel" && !currentTalents["Glass Path: Crystallization"]) {
							isEligible = false;
						} else if (talentName === "Volcanic Glass" && (!currentTalents["Glass Path: Crystallization"] || !currentTalents["Eruption Path: Lava Serpent"])) {
							isEligible = false;
						} else if (talentName === "Reclaimed Glass" && !currentTalents["Crystal Shrapnel"]) {
							isEligible = false;
						} else if (talentName === "Temperature Shock" && !currentTalents["Master Frostdrawer (Crystallization)"]) {
							isEligible = false;
						} else if (talentName === "Hell's Partisan" && !currentTalents["Warding Radiance"]) {
							isEligible = false;
						} else if (talentName === "Rushing Demise" && !currentTalents["Manipulation Path: Agile Misery"]) {
							isEligible = false;
						} else if (talentName === "Protective Offense" && !currentTalents["Manipulation Path: Agile Misery"]) {
							isEligible = false;
						} else if (talentName === "Venomous Chain" && !currentTalents["Manipulation Path: Spirit Lantern"]) {
							isEligible = false;
						} else if (talentName === "Heavy Disease" && !currentTalents["Manipulation Path: Spirit Lantern"]) {
							isEligible = false;
						} else if (talentName === "Peaking Control" && !currentTalents["Simple Manipulation: Unstable Blood"]) {
							isEligible = false;
						} else if (talentName === "Piercing Totality" && !currentTalents["Simple Manipulation: Unstable Blood"]) {
							isEligible = false;
						} else if (talentName === "Split-Second Injection" && !currentTalents["Bleeding Fighter"]) {
							isEligible = false;
						} else if (talentName === "Haunted Path: Specter" && !(currentTalents["Master Galebreather (Specter)"] && currentTalents["Haunted Gale"])) {
							isEligible = false;
						} else if (talentName === "Spectral Shift" && !(currentTalents["Master Galebreather (Specter)"] && currentTalents["Haunted Gale"])) {
							isEligible = false;
						} else if (talentName === "Exoskeleton" && playerStats.TotalFortitude < 40) {
							isEligible = false;
						} else if (talentName === "Magical Resolve" && playerStats.TotalWillpower < 40) {
							isEligible = false;
						} else if (talentName === "Conditioned Runner" && (playerStats.TotalAgility < 25 || playerStats.TotalFortitude < 25)) {
							isEligible = false;
						} else if (talentName === "Pursuit" && (playerStats.TotalAgility < 90 || !hasMantra(playerStats.Mantras, "Revenge"))) {
							isEligible = false;
						} else if (talentName === "Cheap Shot" && playerStats.TotalAgility < 65) {
							isEligible = false;
						} else if (talentName === "Down Comes the Claw" && playerStats.TotalAgility < 75) {
							isEligible = false;
						} else if (talentName === "Maiming Claws" && playerStats.TotalAgility < 100) {
							isEligible = false;
						} else if (talentName === "Tap Dancer" && playerStats.TotalAgility < 60) {
							isEligible = false;
						} else if (talentName === "Reinforced Armor" && playerStats.TotalFortitude < 90) {
							isEligible = false;
						} else if (talentName === "Knight's Rally" && (playerStats.TotalFortitude < 30 || playerStats.TotalWillpower < 10)) {
							isEligible = false;
						} else if (talentName === "Turtle Shell" && playerStats.TotalFortitude < 50) {
							isEligible = false;
						} else if (talentName === "Piercing Blow" && playerStats.TotalStrength < 80) {
							isEligible = false;
						} else if (talentName === "Shield Breaker" && playerStats.TotalStrength < 60) {
							isEligible = false;
						} else if (talentName === "Armorclad" && playerStats.TotalFortitude < 100) {
							isEligible = false;
						} else if (talentName === "Armorclad's Left" && playerStats.TotalFortitude < 100) {
							isEligible = false;
						} else if (talentName === "Underdog" && playerStats.TotalWillpower < 50) {
							isEligible = false;
						} else if (talentName === "Shared Misery" && playerStats.TotalWillpower < 90) {
							isEligible = false;
						} else if (talentName === "All The Dead Gods" && (playerStats.TotalIntelligence < 40 || playerStats.TotalWillpower < 65)) {
							isEligible = false;
						} else if (talentName === "Deflecting Handyman" && playerStats.TotalPrecision < 20) {
							isEligible = false;
						} else if (talentName === "Dead Eye" && playerStats.TotalPrecision < 40) {
							isEligible = false;
						} else if (talentName === "Fatality" && playerStats.TotalPrecision < 80) {
							isEligible = false;
						} else if (talentName === "Sturdy Control" && (playerStats.TotalPrecision < 40 || playerStats.TotalFortitude < 40)) {
							isEligible = false;
						} else if (talentName === "Master of His Craft" && (playerStats.TotalPrecision < 10 || playerStats.TotalIntelligence < 10)) {
							isEligible = false;
						} else if (talentName === "Pinpoint Accuracy" && playerStats.TotalPrecision < 80) {
							isEligible = false;
						} else if (talentName === "Successive Strikes" && playerStats.TotalPrecision < 60) {
							isEligible = false;
						} else if (talentName === "Deadly Blow" && playerStats.TotalPrecision < 50) {
							isEligible = false;
						} else if (talentName === "Stress Resistant" && (playerStats.TotalPrecision < 25 || playerStats.TotalWillpower < 40)) {
							isEligible = false;
						} else if (talentName === "Close Quarters" && playerStats.TotalPrecision < 75) {
							isEligible = false;
						} else if (talentName === "Upcoming Opportunity" && playerStats.TotalPrecision < 90) {
							isEligible = false;
						} else if (talentName === "Professional's Standard" && (playerStats.TotalPrecision < 50 || playerStats.TotalCharisma < 25)) {
							isEligible = false;
						} else if (talentName === "Breaking Stereotype" && (playerStats.TotalPrecision < 50 || playerStats.TotalStrength < 50)) {
							isEligible = false;
						} else if (talentName === "Battle Tendency" && (playerStats.TotalFortitude < 15 || playerStats.TotalWillpower < 15)) {
							isEligible = false;
						} else if (talentName === "Braced Collapse" && playerStats.TotalFortitude < 25) {
							isEligible = false;
						} else if (talentName === "Duelist's Dance" && playerStats.TotalStrength < 20) {
							isEligible = false;
						} else if (talentName === "Unwavering Resolve" && playerStats.TotalStrength < 40) {
							isEligible = false;
						} else if (talentName === "Harsh Response" && playerStats.TotalStrength < 25) {
							isEligible = false;
						} else if (talentName === "Steady Nerves" && (playerStats.TotalStrength < 15 || playerStats.TotalAgility < 40)) {
							isEligible = false;
						} else if (talentName === "Lightspeed Reflexes" && (playerStats.TotalAgility < 20 || playerStats.TotalIntelligence < 20)) {
							isEligible = false;
						} else if (talentName === "Brick Wall" && (playerStats.TotalWillpower < 100 || playerStats.TotalFortitude < 100)) {
							isEligible = false;
						} else if (talentName === "Pleeksty's Faith" && (playerStats.TotalCharisma < 15 || playerStats.TotalElementFire < 25 || playerStats.TotalWillpower < 15)) {
							isEligible = false;
						} else if (talentName === "Dazing Finisher" && playerStats.TotalCharisma < 55) {
							isEligible = false;
						} else if (talentName === "Charismatic Cast" && playerStats.TotalCharisma < 25) {
							isEligible = false;
						} else if (talentName === "Matador" && (playerStats.TotalStrength < 20 || playerStats.TotalAgility < 5)) {
							isEligible = false;
						} else if (talentName === "Tough Love" && playerStats.TotalCharisma < 25) {
							isEligible = false;
						} else if (talentName === "Cold Blood" && (playerStats.TotalFortitude < 50 || playerStats.TotalElementBlood < 20)) {
							isEligible = false;
						} else if (talentName === "Manipulation Path: Agile Misery" && (playerStats.TotalElementBlood < 50 || currentTalents["Manipulation Path: Spirit Lantern"] || currentTalents["Simple Manipulation: Unstable Blood"])) {
							isEligible = false;
						} else if (talentName === "Rushing Demise" && playerStats.TotalElementBlood < 75) {
							isEligible = false;
						} else if (talentName === "Protective Offense" && playerStats.TotalElementBlood < 100) {
							isEligible = false;
						} else if (talentName === "Manipulation Path: Spirit Lantern" && (playerStats.TotalElementBlood < 50 || currentTalents["Manipulation Path: Agile Misery"] || currentTalents["Simple Manipulation: Unstable Blood"])) {
							isEligible = false;
						} else if (talentName === "Venomous Chain" && playerStats.TotalElementBlood < 75) {
							isEligible = false;
						} else if (talentName === "Heavy Disease" && playerStats.TotalElementBlood < 100) {
							isEligible = false;
						} else if (talentName === "Simple Manipulation: Unstable Blood" && (playerStats.TotalElementBlood < 50 || currentTalents["Manipulation Path: Agile Misery"] || currentTalents["Manipulation Path: Spirit Lantern"])) {
							isEligible = false;
						} else if (talentName === "Peaking Control" && playerStats.TotalElementBlood < 75) {
							isEligible = false;
						} else if (talentName === "Piercing Totality" && playerStats.TotalElementBlood < 100) {
							isEligible = false;
						} else if (talentName === "Blood Syphon" && (playerStats.TotalElementBlood < 40 || playerStats.TotalWillpower < 40)) {
							isEligible = false;
						} else if (talentName === "Not So Cheap Trick" && playerStats.TotalElementBlood < 25) {
							isEligible = false;
						} else if (talentName === "Harvest Season" && playerStats.TotalElementBlood < 25) {
							isEligible = false;
						} else if (talentName === "Payback" && (playerStats.TotalElementBlood < 40 || playerStats.TotalStrength < 25)) {
							isEligible = false;
						} else if (talentName === "Emerging Transfusion" && (playerStats.TotalElementBlood < 50 || playerStats.TotalStrength < 50)) {
							isEligible = false;
						} else if (talentName === "Sucker Strike" && playerStats.TotalElementBlood < 80) {
							isEligible = false;
						} else if (talentName === "Lose Your Mind" && playerStats.TotalStrength < 30) {
							isEligible = false;
						} else if (talentName === "Million Ton Piercer" && playerStats.TotalStrength < 90) {
							isEligible = false;
						} else if (talentName === "Ether Overdrive" && playerStats.TotalIntelligence < 90) {
							isEligible = false;
						} else if (talentName === "Foolish Outburst" && playerStats.TotalIntelligence < 50) {
							isEligible = false;
						} else if (talentName === "Dreambreaker" && playerStats.TotalStrength < 100) {
							isEligible = false;
						} else if (talentName === "Collapsed Lung" && playerStats.TotalStrength < 100) {
							isEligible = false;
						} else if (talentName === "Dreambreaker's Left" && playerStats.TotalStrength < 100) {
							isEligible = false;
						} else if (talentName === "Piercing Will" && playerStats.TotalWillpower < 80) {
							isEligible = false;
						} else if (talentName === "Unfazed" && playerStats.TotalWillpower < 50) {
							isEligible = false;
						} else if (talentName === "Grasp on Reality" && (playerStats.TotalWillpower < 5 || playerStats.TotalFortitude < 25)) {
							isEligible = false;
						} else if (talentName === "Disbelief" && playerStats.TotalWillpower < 25) {
							isEligible = false;
						} else if (talentName === "Speed Demon" && playerStats.TotalAgility < 25) {
							isEligible = false;
						} else if (talentName === "Blade Dancer" && playerStats.TotalAgility < 25) {
							isEligible = false;
						} else if (talentName === "Spine Cutter" && (playerStats.TotalStrength < 20 || playerStats.TotalAgility < 25)) {
							isEligible = false;
						} else if (talentName === "Murmer: Ardour" && (playerStats.TotalWillpower < 40 || playerStats.TotalStrength < 20)) {
							isEligible = false;
						} else if (talentName === "To the finish" && playerStats.TotalFortitude < 50) {
							isEligible = false;
						} else if (talentName === "Ether Absorption" && playerStats.TotalIntelligence < 15) {
							isEligible = false;
						} else if (talentName === "Eureka" && playerStats.TotalIntelligence < 30) {
							isEligible = false;
						} else if (talentName === "Overflowing Dam" && playerStats.TotalIntelligence < 40) {
							isEligible = false;
						} else if (talentName === "Twelve Steps Ahead" && playerStats.TotalIntelligence < 80) {
							isEligible = false;
						} else if (talentName === "Lord's Tithe" && (playerStats.TotalElementShadow < 40 || !hasMantra(playerStats.Mantras, "Reinforce"))) {
							isEligible = false;
						} else if (talentName === "Perfect Flash" && playerStats.TotalIntelligence < 20) {
							isEligible = false;
						} else if (talentName === "Charming Master" && playerStats.TotalCharisma < 90) {
							isEligible = false;
						} else if (talentName === "Master Flamecharmer" && playerStats.TotalElementFire < 50) {
							isEligible = false;
						} else if (talentName === "Master Bloodrender" && playerStats.TotalElementBlood < 50) {
							isEligible = false;
						} else if (talentName === "Master Earthbender" && playerStats.TotalElementEarth < 50) {
							isEligible = false;
						} else if (talentName === "Natural Disaster" && playerStats.TotalElementEarth < 50) {
							isEligible = false;
						} else if (talentName === "Memento Mori" && (playerStats.TotalElementEarth < 50 || playerStats.TotalWillpower < 20)) {
							isEligible = false;
						} else if (talentName === "Annihilator" && (playerStats.TotalElementEarth < 50 || playerStats.TotalStrength < 50)) {
							isEligible = false;
						} else if (talentName === "Battlefield Strategist" && playerStats.TotalElementEarth < 40) {
							isEligible = false;
						} else if (talentName === "Impermeable" && playerStats.TotalElementEarth < 80) {
							isEligible = false;
						} else if (talentName === "Solidifier" && playerStats.TotalElementEarth < 100) {
							isEligible = false;
						} else if (talentName === "Master Flamecharmer (Eruption)" && playerStats.TotalElementFire < 50) {
							isEligible = false;
						} else if (talentName === "Eruption Path: Lava Serpent" && playerStats.TotalElementFire < 50) {
							isEligible = false;
						} else if (talentName === "Molten Defense" && playerStats.TotalElementFire < 75) {
							isEligible = false;
						} else if (talentName === "Meteor Impact" && playerStats.TotalElementFire < 25) {
							isEligible = false;
						} else if (talentName === "Flash Point" && playerStats.TotalElementFire < 80) {
							isEligible = false;
						} else if (talentName === "Double Trouble" && playerStats.TotalElementFire < 100) {
							isEligible = false;
						} else if (talentName === "The Final Act" && playerStats.TotalElementFire < 75) {
							isEligible = false;
						} else if (talentName === "Emperor Flame" && playerStats.TotalElementFire < 80) {
							isEligible = false;
						} else if (talentName === "Flamewalker" && (playerStats.TotalElementFire < 40 || playerStats.TotalAgility < 25)) {
							isEligible = false;
						} else if (talentName === "Warding Radiance" && (playerStats.TotalAgility < 20 || playerStats.TotalElementFire < 30)) {
							isEligible = false;
						} else if (talentName === "Azure Flames" && (playerStats.TotalWillpower < 40 || playerStats.TotalElementFire < 75)) {
							isEligible = false;
						} else if (talentName === "Explosive Flourish" && playerStats.TotalElementFire < 50) {
							isEligible = false;
						} else if (talentName === "Flaming Flourish" && playerStats.TotalElementFire < 25) {
							isEligible = false;
						} else if (talentName === "Master Frostdrawer" && playerStats.TotalElementIce < 50) {
							isEligible = false;
						} else if (talentName === "Master Frostdrawer (Crystallization)" && playerStats.TotalElementIce < 50) {
							isEligible = false;
						} else if (talentName === "Glass Path: Crystallization" && playerStats.TotalElementIce < 40) {
							isEligible = false;
						} else if (talentName === "Crystal Shrapnel" && playerStats.TotalElementIce < 60) {
							isEligible = false;
						} else if (talentName === "Volcanic Glass" && playerStats.TotalElementIce < 40) {
							isEligible = false;
						} else if (talentName === "Reclaimed Glass" && playerStats.TotalElementIce < 65) {
							isEligible = false;
						} else if (talentName === "Temperature Shock" && (playerStats.TotalElementIce < 40 || playerStats.TotalElementFire < 40)) {
							isEligible = false;
						} else if (talentName === "Cold Heart" && playerStats.TotalElementIce < 75) {
							isEligible = false;
						} else if (talentName === "Cryostasis" && playerStats.TotalElementIce < 80) {
							isEligible = false;
						} else if (talentName === "Chilling Flourish" && playerStats.TotalElementIce < 50) {
							isEligible = false;
						} else if (talentName === "Unyielding Frost" && playerStats.TotalElementIce < 75) {
							isEligible = false;
						} else if (talentName === "Master Galebreather" && playerStats.TotalElementWind < 50) {
							isEligible = false;
						} else if (talentName === "Master Galebreather (Ember)" && playerStats.TotalElementWind < 50) {
							isEligible = false;
						} else if (talentName === "Scorched Path: Ember" && (playerStats.TotalElementFire < 55 || playerStats.TotalElementWind < 55)) {
							isEligible = false;
						} else if (talentName === "Burning Lungs" && (playerStats.TotalElementWind < 65 || playerStats.TotalElementFire < 65)) {
							isEligible = false;
						} else if (talentName === "Emberlink" && (playerStats.TotalElementWind < 101 || playerStats.TotalElementFire < 101)) {
							isEligible = false;
						} else if (talentName === "Wind Step" && playerStats.TotalElementWind < 40) {
							isEligible = false;
						} else if (talentName === "Air Pressure" && (playerStats.TotalElementWind < 50 || playerStats.TotalAgility < 20)) {
							isEligible = false;
						} else if (talentName === "Master Galebreather (Specter)" && playerStats.TotalElementWind < 50) {
							isEligible = false;
						} else if (talentName === "Haunted Gale" && playerStats.TotalElementWind < 40) {
							isEligible = false;
						} else if (talentName === "Haunted Path: Specter" && playerStats.TotalElementWind < 50) {
							isEligible = false;
						} else if (talentName === "Spectral Shift" && playerStats.TotalElementWind < 75) {
							isEligible = false;
						} else if (talentName === "A World Without Song" && playerStats.TotalElementWind < 75) {
							isEligible = false;
						} else if (talentName === "Suffocating Flourish" && playerStats.TotalElementWind < 50) {
							isEligible = false;
						} else if (talentName === "Master Thundercaller" && playerStats.TotalElementLightning < 50) {
							isEligible = false;
						} else if (talentName === "Electrocution" && playerStats.TotalElementLightning < 50) {
							isEligible = false;
						} else if (talentName === "Raiton Path: Enlightened" && playerStats.TotalElementLightning < 50) {
							isEligible = false;
						} else if (talentName === "Unipolar Path: Teslafication" && (playerStats.TotalElementLightning < 50 || playerStats.TotalElementIron < 50)) {
							isEligible = false;
						} else if (talentName === "Wraith Path: Umbra" && (playerStats.TotalElementFire < 50 || playerStats.TotalElementShadow < 50)) {
							isEligible = false;
						} else if (talentName === "Unipolar Conductivity" && playerStats.TotalElementIron < 75) {
							isEligible = false;
						} else if (talentName === "Decaying Posture" && playerStats.TotalElementIron < 75) {
							isEligible = false;
						} else if (talentName === "Oxidizing Blitz" && playerStats.TotalElementIron < 100) {
							isEligible = false;
						} else if (talentName === "Decay Path: Oxidize" && playerStats.TotalElementIron < 50) {
							isEligible = false;
						} else if (talentName === "Melted Wire" && playerStats.TotalElementLightning < 80) {
							isEligible = false;
						} else if (talentName === "Raiton's Charge" && playerStats.TotalElementLightning < 75) {
							isEligible = false;
						} else if (talentName === "Short Circuit" && playerStats.TotalElementLightning < 75) {
							isEligible = false;
						} else if (talentName === "Scatter" && playerStats.TotalElementLightning < 50) {
							isEligible = false;
						} else if (talentName === "Overload" && playerStats.TotalElementLightning < 100) {
							isEligible = false;
						} else if (talentName === "Master Shadowcaster" && playerStats.TotalElementShadow < 50) {
							isEligible = false;
						} else if (talentName === "There Shall Be No Light" && playerStats.TotalElementShadow < 100) {
							isEligible = false;
						} else if (talentName === "Common State of Inner Violence" && playerStats.TotalElementShadow < 75) {
							isEligible = false;
						} else if (talentName === "Empty Shell" && playerStats.TotalElementShadow < 50) {
							isEligible = false;
						} else if (talentName === "Dark Synergy" && playerStats.TotalElementShadow < 25) {
							isEligible = false;
						} else if (talentName === "Master Ironsinger" && playerStats.TotalElementIron < 50) {
							isEligible = false;
						} else if (talentName === "Armor Synergy" && playerStats.TotalElementIron < 50) {
							isEligible = false;
						} else if (talentName === "An Ironsinger's Instinct" && playerStats.TotalElementIron < 75) {
							isEligible = false;
						} else if (talentName === "Metal Drain" && playerStats.TotalElementIron < 80) {
							isEligible = false;
						} else if (talentName === "Metal Eater" && playerStats.TotalElementIron < 80) {
							isEligible = false;
						} else if (talentName === "Alloyblood" && playerStats.TotalElementIron < 100) {
							isEligible = false;
						} else if (talentName === "Speed Emission" && playerStats.TotalAgility < 25) {
							isEligible = false;
						} else if (talentName === "Armor Conserver" && playerStats.Level < 8) {
							isEligible = false;
						} else if (talentName === "Frozen Pin-Cushion" && (playerStats.TotalElementIce < 60 || !hasMantra(playerStats.Mantras, "Ice Daggers"))) {
							isEligible = false;
						} else if (talentName === "Flash Pressure" && !hasMantra(playerStats.Mantras, "Breeze Blitz")) {
							isEligible = false;
						} else if (talentName === "Blood Path: True Frost" && (playerStats.TotalElementBlood < 20 || playerStats.TotalElementIce < 10)) {
							isEligible = false;
						} else if (talentName === "Agile Path: Pressured Blood" && playerStats.TotalElementBlood < 15) {
							isEligible = false;
						} else if (talentName === "Bleeding Fighter" && (playerStats.TotalElementBlood < 999 || playerStats.TotalStrength < 999)) {
							isEligible = false;
						}
		
						// If eligible and not already selected, add to groupedTalents
						if (isEligible && !currentTalents[talentName]) {
							const rarity = talentData.InnateRarity === "Legendary" ? "Advanced" : talentData.InnateRarity || "Common";
							const className = talentData.Class || "Miscellaneous";
		
							if (!groupedTalents[rarity][className]) {
								groupedTalents[rarity][className] = [];
							}
		
							groupedTalents[rarity][className].push({
								name: talentName,
								desc: talentData.Desc,
								icon: talentData.Icon || "https://deepwoken.co/newicon.png" // Default icon if none provided
							});
						}
					}
		
					// Populate each dropdown
					populateDropdown('Advanced-dropdown', groupedTalents.Advanced, 'Advanced');
					populateDropdown('Rare-dropdown', groupedTalents.Rare, 'Rare');
					populateDropdown('Common-dropdown', groupedTalents.Common, 'Common');
				}
		
				function populateDropdown(dropdownId, talentsByClass, rarity) {
					const dropdown = document.getElementById(dropdownId);
					if (!dropdown) return;
		
					// Clear existing content
					dropdown.innerHTML = '';
		
					// Populate fieldsets for each class
					for (const [className, talents] of Object.entries(talentsByClass)) {
						const fieldset = document.createElement('fieldset');
						fieldset.className = 'svelte-hwcpcr';
		
						const legend = document.createElement('legend');
						legend.className = 'svelte-hwcpcr';
						legend.textContent = className;
						fieldset.appendChild(legend);
		
						// Add talents to the fieldset
						talents.forEach(talent => {
							const talentDiv = document.createElement('div');
							talentDiv.className = `talent ${rarity} shrine-false locked-false svelte-hwcpcr`;
							talentDiv.setAttribute('role', 'button');
							talentDiv.setAttribute('tabindex', '0');
							talentDiv.style.userSelect = 'none';
							talentDiv.style.touchAction = 'auto';
							talentDiv.dataset.talentName = talent.name; // Store talent name for reference
		
							// Talent name and icon
							talentDiv.innerHTML = `
							  ${talent.name}
							  <div class="svelte-hwcpcr" style="display: flex; gap: 4px;">
								<img class="icon svelte-hwcpcr" title="${talent.desc}" width="14" height="14" alt="new" src="${talent.icon}">
							  </div>
							`;
		
							// Add click event to move talent to obtained talents
							talentDiv.addEventListener('click', () => {
								if (!currentTalents[talent.name]) {
									currentTalents[talent.name] = true;
									populateObtainedTalents(currentTalents, talents);
									populateDropdowns(talents, currentTalents, updatePlayerStats()); // Pass original talents data
								}
							});
		
							fieldset.appendChild(talentDiv);
						});
		
						dropdown.appendChild(fieldset);
					}
		
					// If no talents, show "No talents :("
					if (dropdown.innerHTML.trim() === '') {
						const noTalentsDiv = document.createElement('div');
						noTalentsDiv.className = 'talent svelte-hwcpcr';
						noTalentsDiv.textContent = 'No talents :(';
						dropdown.appendChild(noTalentsDiv);
					}
				}
		
				function populateObtainedTalents(currentTalents, talentsData) {
					const obtainedTalentsContainer = document.querySelector('#rollable-talent-2 .talents-container');
					if (!obtainedTalentsContainer) return;
		
					// Clear existing content
					obtainedTalentsContainer.innerHTML = '';
		
					// Group obtained talents by class
					const groupedObtainedTalents = {};
					for (const [talentName] of Object.entries(currentTalents)) {
						if (talentsData[talentName]) {
							const className = talentsData[talentName].Class || "Miscellaneous";
							if (!groupedObtainedTalents[className]) {
								groupedObtainedTalents[className] = [];
							}
							groupedObtainedTalents[className].push({
								name: talentName,
								desc: talentsData[talentName].Desc,
								icon: talentsData[talentName].Icon = "https://deepwoken.co/newicon.png"
							});
						}
					}
		
					// Sort classes alphabetically
					const sortedClasses = Object.keys(groupedObtainedTalents).sort();
		
					// Populate fieldsets for each class
					sortedClasses.forEach(className => {
						const fieldset = document.createElement('fieldset');
						fieldset.className = 'svelte-hwcpcr';
		
						const legend = document.createElement('legend');
						legend.className = 'svelte-hwcpcr';
						legend.textContent = className;
						fieldset.appendChild(legend);
		
						// Add talents to the fieldset
						groupedObtainedTalents[className].forEach(talent => {
							const talentDiv = document.createElement('div');
							talentDiv.className = `talent svelte-hwcpcr`;
							talentDiv.style.userSelect = 'none';
							talentDiv.style.touchAction = 'auto';
		
							// Talent name and icon
							talentDiv.innerHTML = `
							  ${talent.name}
							  <div class="svelte-hwcpcr" style="display: flex; gap: 4px;">
								<img class="icon svelte-hwcpcr" title="${talent.desc}" width="14" height="14" alt="new" src="${talent.icon}">
							  </div>
							`;
		
							fieldset.appendChild(talentDiv);
						});
		
						obtainedTalentsContainer.appendChild(fieldset);
					});
		
					// Update the obtained talents count
					const obtainedCount = Object.keys(currentTalents).length;
					const obtainedCountElement = document.querySelector('#rollable-talent-2 .svelte-hwcpcr:nth-child(2) b:first-child');
					if (obtainedCountElement) obtainedCountElement.textContent = obtainedCount;
		
					// Update rarity counts (simplified, adjust as needed)
					const rareCount = Object.entries(currentTalents).filter(([name]) => talentsData[name]?.InnateRarity === "Rare").length;
					const advancedCount = Object.entries(currentTalents).filter(([name]) => talentsData[name]?.InnateRarity === "Legendary").length;
					const rareCountElement = document.querySelector('#rollable-talent-2 .Rare:nth-child(2)');
					const advancedCountElement = document.querySelector('#rollable-talent-2 .Advanced:nth-child(2)');
					if (rareCountElement) rareCountElement.textContent = rareCount;
					if (advancedCountElement) advancedCountElement.textContent = advancedCount;
				}
			});
		</script>
    </div>
    <div class="grid-item obtained-talents svelte-hwcpcr" id="rollable-talent-2">
        <div style="text-align: center" class="svelte-hwcpcr"><b class="svelte-hwcpcr" data-svelte-h="svelte-17jxel1">Obtained Talents</b> <i style="color: gray" class="svelte-hwcpcr">0</i></div>
        <div style="display: flex; justify-content: space-around" class="svelte-hwcpcr"><b class=" svelte-hwcpcr">0</b> <b class="Rare svelte-hwcpcr">0</b> <b class="Advanced svelte-hwcpcr">0</b></div>
        <div style="text-align: center; font-size: 12px; color: rgba(0, 0, 0, 0.5)" class="svelte-hwcpcr">Max of <b class="svelte-hwcpcr">76</b> talents, <b class="svelte-hwcpcr" data-svelte-h="svelte-1fec9zz">50</b> rollable
            (<b class="Rare svelte-hwcpcr">40</b> guaranteed rare attempts) and
            <b class="svelte-hwcpcr">24</b> from Roll 2
        </div>
        <div style="display: flex; flex-direction: row; align-items: center; gap: 5px" class="svelte-hwcpcr"><input type="text" placeholder="Search talents..." aria-autocomplete="none" class="svelte-hwcpcr"> <img src="/alphabetical.png" alt="sort" width="14" height="14" style="cursor: pointer; filter: invert(50%)" class="svelte-hwcpcr"> <img src="/check.png" alt="compare" width="14" height="14" style="cursor: pointer;" class="svelte-hwcpcr"></div> <button class="filters-display off svelte-hwcpcr" data-svelte-h="svelte-118qp2v">Filters</button>
        <div class="filters svelte-hwcpcr" style="display: none"><button class="filter pre false svelte-hwcpcr" tabindex="0">PRE <img class="icon svelte-hwcpcr" title="This talent is only obtainable pre-shrine." width="14" height="14" alt="new" src="/shrineicon.png" style="margin-left: 3px"> </button><button class="filter post false svelte-hwcpcr" tabindex="0">POST </button><button class="filter fav false svelte-hwcpcr" tabindex="0">FAV <img class="icon svelte-hwcpcr" title="This talent was favorited by the build's creator!" width="14" height="14" alt="new" src="/lovedicon.png" style="margin-left: 3px"> </button><button class="filter str false svelte-hwcpcr" tabindex="0">STR </button><button class="filter agi false svelte-hwcpcr" tabindex="0">AGI </button><button class="filter ftd false svelte-hwcpcr" tabindex="0">FTD </button><button class="filter int false svelte-hwcpcr" tabindex="0">INT </button><button class="filter wil false svelte-hwcpcr" tabindex="0">WIL </button><button class="filter cha false svelte-hwcpcr" tabindex="0">CHA </button><button class="filter attunement false svelte-hwcpcr" tabindex="0">ATTUNEMENT </button></div>
        <div id="" class="talents-container svelte-hwcpcr" style="display: flex; margin-top: 10px">
            <div class="talent svelte-hwcpcr" data-svelte-h="svelte-134h4x0">You can click on the talents to pick them!</div>
        </div>
    </div>
</div><div class="container" id="Stats">
		 <div class="meta-stats grid-item border svelte-g2d5k9">
			<div class="stat-item svelte-g2d5k9">
			   <b class="svelte-g2d5k9">Race</b> 
			   <select class="meta-selections input svelte-g2d5k9" label="Race" id="Race" stattype="meta" statname="Race">
				  <option value="1" style="">Etrean</option>
				  <option value="2" style="">Celtor</option>
				  <option value="3" style="">Adret</option>
				  <option value="4" style="">Canor</option>
				  <option value="5" style="">Gremor</option>
				  <option value="6" style="">Khan</option>
				  <option value="7" style="">Felinor</option>
				  <option value="8" style="">Vesperian</option>
				  <option value="9" style="">Capra</option>
				  <option value="10" style="">Ganymede</option>
				  <option value="11" style="">Tiran</option>
				  <option value="12" style="">Drakkard</option>
				  <option value="13" style="">Heliodar</option>
				  <option value="14" style="">Arch Vesperian</option>
				  <option value="15" style="">Nuttoons Vesperian</option>
				  <option value="16" style="">Lightborn</option>
				  <option value="17" style="">Hive</option>
				  <option value="18" style="">Reginald</option>
				  <option value="19" style="">Celestial</option>
				  <option value="20" style="">Yang</option>
				  <option value="21" style="">Yin</option>
				  <option value="22" style="">Pseudo Capra</option>
				  <option value="23" style="">VoidKaninchen</option>
			   </select>
			</div>
			<div class="stat-item svelte-g2d5k9">
			   <b class="svelte-g2d5k9">Oath</b> 
			   <select class="meta-selections input svelte-g2d5k9" label="Oath" id="Oath" stattype="meta" statname="Oath">
				  <option value="1">Oathless</option>
				  <option value="2">Blindseer</option>
				  <option value="3">Starkindred</option>
				  <option value="4">Arcwarder</option>
				  <option value="5">Jetstriker</option>
				  <option value="6">Dawnwalker</option>
				  <option value="7">Silentheart</option>
				  <option value="8">Old Silentheart</option>
				  <option value="9">Chainwarden</option>
				  <option value="10">Bladeharper</option>
				  <option value="11">Brother, of the Middle</option>
                  <option value="12">Ironfist</option>
			   </select>
			</div>
			<div class="stat-item svelte-g2d5k9">
			   <b class="svelte-g2d5k9">Murmur</b> 
			   <select class="meta-selections input svelte-g2d5k9" label="Murmur" id="Murmur" stattype="meta" statname="Murmur">
				  <option value="1">Ardour</option>
			   </select>
			</div>
			<div class="stat-item svelte-g2d5k9">
			   <b class="svelte-g2d5k9">Bell</b> 
			   <select class="meta-selections input svelte-g2d5k9" label="Bell" id="Bell" stattype="meta" statname="Bell">
				  <option value="1">Blood Scourge</option>
				  <option value="2">Reaper</option>
				  <option value="3">Payback</option>
				  <option value="4">Crazy Slots</option>
				  <option value="5">Shard Bow</option>
				  <option value="7">Wind Up</option>
				  <option value="8">Portals</option>
				  <option value="9">Dimensional Travel</option>
				  <option value="10">Ultra Instinct Sign</option>
				  <option value="11">Manifest Ego</option>
				  <option value="12">Crescent Peridition</option>
			   </select>
			</div>
		 </div>
		 <div class="stats svelte-g2d5k9">
			<div class="misc-stats border svelte-g2d5k9">
			   <div style="margin: 5px;"><b class="svelte-g2d5k9" data-svelte-h="svelte-iv4t0z">Power:</b> 0</div>
			   <div style="margin: 5px;"><b class="svelte-g2d5k9" data-svelte-h="svelte-6r52p6">Next Power:</b> 15 points</div>
			   <div style="margin: 5px;">
				 <i style="opacity: 25%" id="randomText">This ui is ripped straight from Deepwoken Builder, sorry.</i>
			   </div>
			</div>
			<div class="basic-stats border svelte-g2d5k9">
			   <div class="stat-item svelte-g2d5k9">
				  <b class="svelte-g2d5k9">Strength</b> 
				  <div class="stat-number svelte-g2d5k9">
					 <div class="preshrine-stat svelte-g2d5k9" data-svelte-h="svelte-1w68m8n"><i>0</i></div>
					 <input class="stat-input input svelte-g2d5k9" value="0" statname="Strength" stattype="base">
				  </div>
			   </div>
			   <div class="stat-item svelte-g2d5k9">
				  <b class="svelte-g2d5k9">Precision</b> 
				  <div class="stat-number svelte-g2d5k9">
					 <div class="preshrine-stat svelte-g2d5k9" data-svelte-h="svelte-1w68m8n"><i>0</i></div>
					 <input class="stat-input input svelte-g2d5k9" value="0" statname="Precision" stattype="base">
				  </div>
			   </div>
			   <div class="stat-item svelte-g2d5k9">
				  <b class="svelte-g2d5k9">Fortitude</b> 
				  <div class="stat-number svelte-g2d5k9">
					 <div class="preshrine-stat svelte-g2d5k9" data-svelte-h="svelte-1w68m8n"><i>0</i></div>
					 <input class="stat-input input svelte-g2d5k9" value="0" statname="Fortitude" stattype="base">
				  </div>
			   </div>
			   <div class="stat-item svelte-g2d5k9">
				  <b class="svelte-g2d5k9">Agility</b> 
				  <div class="stat-number svelte-g2d5k9">
					 <div class="preshrine-stat svelte-g2d5k9" data-svelte-h="svelte-1w68m8n"><i>0</i></div>
					 <input class="stat-input input svelte-g2d5k9" value="0" statname="Agility" stattype="base">
				  </div>
			   </div>
			   <div class="stat-item svelte-g2d5k9">
				  <b class="svelte-g2d5k9">Intelligence</b> 
				  <div class="stat-number svelte-g2d5k9">
					 <div class="preshrine-stat svelte-g2d5k9" data-svelte-h="svelte-1w68m8n"><i>0</i></div>
					 <input class="stat-input input svelte-g2d5k9" value="0" statname="Intelligence" stattype="base">
				  </div>
			   </div>
			   <div class="stat-item svelte-g2d5k9">
				  <b class="svelte-g2d5k9">Willpower</b> 
				  <div class="stat-number svelte-g2d5k9">
					 <div class="preshrine-stat svelte-g2d5k9" data-svelte-h="svelte-1w68m8n"><i>0</i></div>
					 <input class="stat-input input svelte-g2d5k9" value="0" statname="Willpower" stattype="base">
				  </div>
			   </div>
			   <div class="stat-item svelte-g2d5k9">
				  <b class="svelte-g2d5k9">Charisma</b> 
				  <div class="stat-number svelte-g2d5k9">
					 <div class="preshrine-stat svelte-g2d5k9" data-svelte-h="svelte-1w68m8n"><i>0</i></div>
					 <input class="stat-input input svelte-g2d5k9" value="0" statname="Charisma" stattype="base">
				  </div>
			   </div>
			</div>
		 </div>
		 <div class="stats svelte-g2d5k9">
			<div class="weapon-stats border svelte-g2d5k9">
			   <div class="stat-item svelte-g2d5k9">
				  <b class="svelte-g2d5k9">Heavy Wep.</b> 
				  <div class="stat-number svelte-g2d5k9"> <input class="stat-input input svelte-g2d5k9" value="0" statname="Heavy Wep." stattype="weapon"></div>
			   </div>
			   <div class="stat-item svelte-g2d5k9">
				  <b class="svelte-g2d5k9">Medium Wep.</b> 
				  <div class="stat-number svelte-g2d5k9"> <input class="stat-input input svelte-g2d5k9" value="0" statname="Medium Wep." stattype="weapon"></div>
			   </div>
			   <div class="stat-item svelte-g2d5k9">
				  <b class="svelte-g2d5k9">Light Wep.</b> 
				  <div class="stat-number svelte-g2d5k9"> <input class="stat-input input svelte-g2d5k9" value="0" statname="Light Wep." stattype="weapon"></div>
			   </div>
			</div>
			<div class="attunement-stats border svelte-g2d5k9">
			   <div class="stat-item svelte-g2d5k9">
				  <b class="svelte-g2d5k9">Flamecharm</b> 
				  <div class="stat-number svelte-g2d5k9"> <input class="stat-input input svelte-g2d5k9" value="0" statname="Flamecharm" stattype="attunement"></div>
			   </div>
			   <div class="stat-item svelte-g2d5k9">
				  <b class="svelte-g2d5k9">Frostdraw</b> 
				  <div class="stat-number svelte-g2d5k9"> <input class="stat-input input svelte-g2d5k9" value="0" statname="Frostdraw" stattype="attunement"></div>
			   </div>
			   <div class="stat-item svelte-g2d5k9">
				  <b class="svelte-g2d5k9">Thundercall</b> 
				  <div class="stat-number svelte-g2d5k9"> <input class="stat-input input svelte-g2d5k9" value="0" statname="Thundercall" stattype="attunement"></div>
			   </div>
			   <div class="stat-item svelte-g2d5k9">
				  <b class="svelte-g2d5k9">Galebreathe</b> 
				  <div class="stat-number svelte-g2d5k9"> <input class="stat-input input svelte-g2d5k9" value="0" statname="Galebreathe" stattype="attunement"></div>
			   </div>
			   <div class="stat-item svelte-g2d5k9">
				  <b class="svelte-g2d5k9">Shadowcast</b> 
				  <div class="stat-number svelte-g2d5k9"> <input class="stat-input input svelte-g2d5k9" value="0" statname="Shadowcast" stattype="attunement"></div>
			   </div>
			   <div class="stat-item svelte-g2d5k9">
				  <b class="svelte-g2d5k9">Ironsing</b> 
				  <div class="stat-number svelte-g2d5k9"> <input class="stat-input input svelte-g2d5k9" value="0" statname="Ironsing" stattype="attunement"></div>
			   </div>
			   <div class="stat-item svelte-g2d5k9">
				  <b class="svelte-g2d5k9">Bloodrend</b> 
				  <div class="stat-number svelte-g2d5k9"> <input class="stat-input input svelte-g2d5k9" value="0" statname="Bloodrend" stattype="attunement"></div>
			   </div>
			   <div class="stat-item svelte-g2d5k9">
				  <b class="svelte-g2d5k9">Earthbend</b> 
				  <div class="stat-number svelte-g2d5k9"> <input class="stat-input input svelte-g2d5k9" value="0" statname="Bloodrend" stattype="attunement"></div>
			   </div>
			</div>
		 </div>
		 <div class="points-info grid-item border svelte-g2d5k9" ignore-in-export="">
			<div><b class="svelte-g2d5k9" data-svelte-h="svelte-193dcio">Investment Points</b></div>
			<div><b class="svelte-g2d5k9" data-svelte-h="svelte-t0eua9">Points Spent</b></div>
		 </div>
		 <div class="functions grid-item svelte-g2d5k9" ignore-in-export="">
            <a id="newBuildButton" class="function-button overworld border-thin svelte-g2d5k9" href="builder.html" data-svelte-h="svelte-owdpb5">New Build</a>
            <hr style="width: 100%"> 
        
            <div class="functions grid-item svelte-g2d5k9" ignore-in-export="">
                <button id="exportcode" href="javascript:void(0);" class="function-button border-thin svelte-g2d5k9" data-svelte-h="svelte-oiyxom">
                    <div><b class="svelte-g2d5k9">Export</b> as a code</div>
                </button>  
            </div>
            
			<script>
				document.addEventListener('DOMContentLoaded', function () {
					// Stats mapping from the export script
					const statsMapping = {
						st: 'Strength',
						pe: 'Precision',
						fo: 'Fortitude',
						ag: 'Agility',
						in: 'Intelligence',
						wi: 'Willpower',
						ch: 'Charisma',
						he: 'Heavy Wep.',
						me: 'Medium Wep.',
						li: 'Light Wep.',
						fl: 'Flamecharm',
						fr: 'Frostdraw',
						th: 'Thundercall',
						ga: 'Galebreathe',
						sh: 'Shadowcast',
						ir: 'Ironsing',
						bl: 'Bloodrend',
						eb: 'Earthbend',
						ra: 'Race',
						oa: 'Oath',
						mu: 'Murmur',
						be: 'Bell'
					};
			
					// Map shorthand keys to Lua-style Total[Stat] keys
					const luaStatsMapping = {
						st: 'TotalStrength',
						pe: 'TotalPrecision',
						fo: 'TotalFortitude',
						ag: 'TotalAgility',
						in: 'TotalIntelligence',
						wi: 'TotalWillpower',
						ch: 'TotalCharisma',
						fl: 'TotalElementFire',
						fr: 'TotalElementIce',
						th: 'TotalElementLightning',
						ga: 'TotalElementWind',
						sh: 'TotalElementShadow',
						ir: 'TotalElementIron',
						bl: 'TotalElementBlood',
						eb: 'TotalElementEarth'
					};
			
					// Function to collect and update player stats
					function updatePlayerStats() {
						const stats = {};
						Object.keys(statsMapping).forEach(key => {
							const input = document.querySelector(`input[statname="${statsMapping[key]}"]`);
							const select = document.querySelector(`select[statname="${statsMapping[key]}"]`);
			
							if (input) {
								stats[key] = parseInt(input.value) || 0;
							} else if (select) {
								stats[key] = select.value || 0;
							} else {
								stats[key] = 0; // Default to 0 if no input or select found
							}
						});
			
						const playerStats = {};
						Object.keys(stats).forEach(key => {
							if (luaStatsMapping[key]) {
								playerStats[luaStatsMapping[key]] = stats[key];
							}
						});
			
						const levelInput = document.querySelector('input[statname="Level"]');
						playerStats.Level = levelInput ? parseInt(levelInput.value) || 0 : 0;
			
						const mantrasInput = document.querySelector('input[statname="Mantras"]') || document.querySelector('select[statname="Mantras"]');
						playerStats.Mantras = mantrasInput ? mantrasInput.value : "";
			
						return playerStats;
					}
			
					// Simulated current talents
					let currentTalents = {
						"Risky Moves": true,
					};
			
					// Store the full talents data globally
					let talentsData = null;
			
					// Fetch the JSON file and populate initially
					fetch('talents.json')
						.then(response => response.json())
						.then(data => {
							talentsData = data.TalentsInfo; // Store the full talents data
							const playerStats = updatePlayerStats();
							populateDropdowns(talentsData, currentTalents, playerStats);
							populateObtainedTalents(currentTalents, talentsData);
			
							// Add event listeners to update talents when stats change
							Object.values(statsMapping).forEach(statName => {
								const input = document.querySelector(`input[statname="${statName}"]`);
								const select = document.querySelector(`select[statname="${statName}"]`);
								if (input) {
									input.addEventListener('input', () => {
										const updatedStats = updatePlayerStats();
										populateDropdowns(talentsData, currentTalents, updatedStats);
									});
								} else if (select) {
									select.addEventListener('change', () => {
										const updatedStats = updatePlayerStats();
										populateDropdowns(talentsData, currentTalents, updatedStats);
									});
								}
							});
			
							const levelInput = document.querySelector('input[statname="Level"]');
							if (levelInput) {
								levelInput.addEventListener('input', () => {
									const updatedStats = updatePlayerStats();
									populateDropdowns(talentsData, currentTalents, updatedStats);
								});
							}
							const mantrasInput = document.querySelector('input[statname="Mantras"]') || document.querySelector('select[statname="Mantras"]');
							if (mantrasInput) {
								mantrasInput.addEventListener('input', () => {
									const updatedStats = updatePlayerStats();
									populateDropdowns(talentsData, currentTalents, updatedStats);
								});
								if (mantrasInput.tagName === 'SELECT') {
									mantrasInput.addEventListener('change', () => {
										const updatedStats = updatePlayerStats();
										populateDropdowns(talentsData, currentTalents, updatedStats);
									});
								}
							}
						})
						.catch(error => console.error('Error loading talents:', error));
			
					function populateDropdowns(talents, currentTalents, playerStats) {
						const groupedTalents = {
							Advanced: {},
							Rare: {},
							Common: {}
						};
			
						function hasMantra(mantras, mantraName) {
							return mantras && typeof mantras === 'string' ? mantras.includes(mantraName) : false;
						}
			
						for (const [talentName, talentData] of Object.entries(talents)) {
							let isEligible = true;
			
							if (!talents[talentName]) {
								console.warn("⚠️ Invalid talent detected:", talentName);
								continue;
							}
			
							// Apply Lua logic to determine eligibility
							if (talentName === "Ghost" && !currentTalents["Risky Moves"]) {
								isEligible = false;
							} else if (talentName === "Scatter" && !currentTalents["Electrocution"]) {
								isEligible = false;
							} else if (talentName === "Emperor Flame" && !currentTalents["The Final Act"]) {
								isEligible = false;
							} else if (talentName === "Short Circuit" && !currentTalents["Electrocution"]) {
								isEligible = false;
							} else if (talentName === "Decaying Posture" && !currentTalents["Decay Path: Oxidize"]) {
								isEligible = false;
							} else if (talentName === "Oxidizing Blitz" && !currentTalents["Decay Path: Oxidize"]) {
								isEligible = false;
							} else if (talentName === "Unipolar Conductivity" && !currentTalents["Unipolar Path: Teslafication"]) {
								isEligible = false;
							} else if (talentName === "Melted Wire" && !currentTalents["Unipolar Path: Teslafication"]) {
								isEligible = false;
							} else if (talentName === "Raiton's Charge" && !currentTalents["Raiton Path: Enlightened"]) {
								isEligible = false;
							} else if (talentName === "Overcharge" && !currentTalents["Unipolar Path: Teslafication"]) {
								isEligible = false;
							} else if (talentName === "Molten Defense" && !currentTalents["Eruption Path: Lava Serpent"]) {
								isEligible = false;
							} else if (talentName === "Flash Point" && !currentTalents["Eruption Path: Lava Serpent"]) {
								isEligible = false;
							} else if (talentName === "The Floor is Lava" && !currentTalents["Eruption Path: Lava Serpent"]) {
								isEligible = false;
							} else if (talentName === "Double Trouble" && !currentTalents["Eruption Path: Lava Serpent"]) {
								isEligible = false;
							} else if (talentName === "Tough Love" && !currentTalents["Charismatic Cast"]) {
								isEligible = false;
							} else if (talentName === "Magical Resolve" && !currentTalents["Battle Tendency"]) {
								isEligible = false;
							} else if (talentName === "Turtle Shell" && !currentTalents["Knight's Rally"]) {
								isEligible = false;
							} else if (talentName === "Maiming Claws" && !currentTalents["Down Comes the Claw"]) {
								isEligible = false;
							} else if (talentName === "Crystal Shrapnel" && !currentTalents["Glass Path: Crystallization"]) {
								isEligible = false;
							} else if (talentName === "Volcanic Glass" && (!currentTalents["Glass Path: Crystallization"] || !currentTalents["Eruption Path: Lava Serpent"])) {
								isEligible = false;
							} else if (talentName === "Reclaimed Glass" && !currentTalents["Crystal Shrapnel"]) {
								isEligible = false;
							} else if (talentName === "Temperature Shock" && !currentTalents["Master Frostdrawer (Crystallization)"]) {
								isEligible = false;
							} else if (talentName === "Hell's Partisan" && !currentTalents["Warding Radiance"]) {
								isEligible = false;
							} else if (talentName === "Rushing Demise" && !currentTalents["Manipulation Path: Agile Misery"]) {
								isEligible = false;
							} else if (talentName === "Protective Offense" && !currentTalents["Manipulation Path: Agile Misery"]) {
								isEligible = false;
							} else if (talentName === "Venomous Chain" && !currentTalents["Manipulation Path: Spirit Lantern"]) {
								isEligible = false;
							} else if (talentName === "Heavy Disease" && !currentTalents["Manipulation Path: Spirit Lantern"]) {
								isEligible = false;
							} else if (talentName === "Peaking Control" && !currentTalents["Simple Manipulation: Unstable Blood"]) {
								isEligible = false;
							} else if (talentName === "Piercing Totality" && !currentTalents["Simple Manipulation: Unstable Blood"]) {
								isEligible = false;
							} else if (talentName === "Split-Second Injection" && !currentTalents["Bleeding Fighter"]) {
								isEligible = false;
							} else if (talentName === "Haunted Path: Specter" && !(currentTalents["Master Galebreather (Specter)"] && currentTalents["Haunted Gale"])) {
								isEligible = false;
							} else if (talentName === "Spectral Shift" && !(currentTalents["Master Galebreather (Specter)"] && currentTalents["Haunted Gale"])) {
								isEligible = false;
							} else if (talentName === "Exoskeleton" && playerStats.TotalFortitude < 40) {
								isEligible = false;
							} else if (talentName === "Magical Resolve" && playerStats.TotalWillpower < 40) {
								isEligible = false;
							} else if (talentName === "Conditioned Runner" && (playerStats.TotalAgility < 25 || playerStats.TotalFortitude < 25)) {
								isEligible = false;
							} else if (talentName === "Pursuit" && (playerStats.TotalAgility < 90 || !hasMantra(playerStats.Mantras, "Revenge"))) {
								isEligible = false;
							} else if (talentName === "Cheap Shot" && playerStats.TotalAgility < 65) {
								isEligible = false;
							} else if (talentName === "Down Comes the Claw" && playerStats.TotalAgility < 75) {
								isEligible = false;
							} else if (talentName === "Maiming Claws" && playerStats.TotalAgility < 100) {
								isEligible = false;
							} else if (talentName === "Tap Dancer" && playerStats.TotalAgility < 60) {
								isEligible = false;
							} else if (talentName === "Reinforced Armor" && playerStats.TotalFortitude < 90) {
								isEligible = false;
							} else if (talentName === "Knight's Rally" && (playerStats.TotalFortitude < 30 || playerStats.TotalWillpower < 10)) {
								isEligible = false;
							} else if (talentName === "Turtle Shell" && playerStats.TotalFortitude < 50) {
								isEligible = false;
							} else if (talentName === "Piercing Blow" && playerStats.TotalStrength < 80) {
								isEligible = false;
							} else if (talentName === "Shield Breaker" && playerStats.TotalStrength < 60) {
								isEligible = false;
							} else if (talentName === "Armorclad" && playerStats.TotalFortitude < 100) {
								isEligible = false;
							} else if (talentName === "Armorclad's Left" && playerStats.TotalFortitude < 100) {
								isEligible = false;
							} else if (talentName === "Underdog" && playerStats.TotalWillpower < 50) {
								isEligible = false;
							} else if (talentName === "Shared Misery" && playerStats.TotalWillpower < 90) {
								isEligible = false;
							} else if (talentName === "All The Dead Gods" && (playerStats.TotalIntelligence < 40 || playerStats.TotalWillpower < 65)) {
								isEligible = false;
							} else if (talentName === "Deflecting Handyman" && playerStats.TotalPrecision < 20) {
								isEligible = false;
							} else if (talentName === "Dead Eye" && playerStats.TotalPrecision < 40) {
								isEligible = false;
							} else if (talentName === "Fatality" && playerStats.TotalPrecision < 80) {
								isEligible = false;
							} else if (talentName === "Sturdy Control" && (playerStats.TotalPrecision < 40 || playerStats.TotalFortitude < 40)) {
								isEligible = false;
							} else if (talentName === "Master of His Craft" && (playerStats.TotalPrecision < 10 || playerStats.TotalIntelligence < 10)) {
								isEligible = false;
							} else if (talentName === "Pinpoint Accuracy" && playerStats.TotalPrecision < 80) {
								isEligible = false;
							} else if (talentName === "Successive Strikes" && playerStats.TotalPrecision < 60) {
								isEligible = false;
							} else if (talentName === "Deadly Blow" && playerStats.TotalPrecision < 50) {
								isEligible = false;
							} else if (talentName === "Stress Resistant" && (playerStats.TotalPrecision < 25 || playerStats.TotalWillpower < 40)) {
								isEligible = false;
							} else if (talentName === "Close Quarters" && playerStats.TotalPrecision < 75) {
								isEligible = false;
							} else if (talentName === "Upcoming Opportunity" && playerStats.TotalPrecision < 90) {
								isEligible = false;
							} else if (talentName === "Professional's Standard" && (playerStats.TotalPrecision < 50 || playerStats.TotalCharisma < 25)) {
								isEligible = false;
							} else if (talentName === "Breaking Stereotype" && (playerStats.TotalPrecision < 50 || playerStats.TotalStrength < 50)) {
								isEligible = false;
							} else if (talentName === "Battle Tendency" && (playerStats.TotalFortitude < 15 || playerStats.TotalWillpower < 15)) {
								isEligible = false;
							} else if (talentName === "Braced Collapse" && playerStats.TotalFortitude < 25) {
								isEligible = false;
							} else if (talentName === "Duelist's Dance" && playerStats.TotalStrength < 20) {
								isEligible = false;
							} else if (talentName === "Unwavering Resolve" && playerStats.TotalStrength < 40) {
								isEligible = false;
							} else if (talentName === "Harsh Response" && playerStats.TotalStrength < 25) {
								isEligible = false;
							} else if (talentName === "Steady Nerves" && (playerStats.TotalStrength < 15 || playerStats.TotalAgility < 40)) {
								isEligible = false;
							} else if (talentName === "Lightspeed Reflexes" && (playerStats.TotalAgility < 20 || playerStats.TotalIntelligence < 20)) {
								isEligible = false;
							} else if (talentName === "Brick Wall" && (playerStats.TotalWillpower < 100 || playerStats.TotalFortitude < 100)) {
								isEligible = false;
							} else if (talentName === "Pleeksty's Faith" && (playerStats.TotalCharisma < 15 || playerStats.TotalElementFire < 25 || playerStats.TotalWillpower < 15)) {
								isEligible = false;
							} else if (talentName === "Dazing Finisher" && playerStats.TotalCharisma < 55) {
								isEligible = false;
							} else if (talentName === "Charismatic Cast" && playerStats.TotalCharisma < 25) {
								isEligible = false;
							} else if (talentName === "Matador" && (playerStats.TotalStrength < 20 || playerStats.TotalAgility < 5)) {
								isEligible = false;
							} else if (talentName === "Tough Love" && playerStats.TotalCharisma < 25) {
								isEligible = false;
							} else if (talentName === "Cold Blood" && (playerStats.TotalFortitude < 50 || playerStats.TotalElementBlood < 20)) {
								isEligible = false;
							} else if (talentName === "Manipulation Path: Agile Misery" && (playerStats.TotalElementBlood < 50 || currentTalents["Manipulation Path: Spirit Lantern"] || currentTalents["Simple Manipulation: Unstable Blood"])) {
								isEligible = false;
							} else if (talentName === "Rushing Demise" && playerStats.TotalElementBlood < 75) {
								isEligible = false;
							} else if (talentName === "Protective Offense" && playerStats.TotalElementBlood < 100) {
								isEligible = false;
							} else if (talentName === "Manipulation Path: Spirit Lantern" && (playerStats.TotalElementBlood < 50 || currentTalents["Manipulation Path: Agile Misery"] || currentTalents["Simple Manipulation: Unstable Blood"])) {
								isEligible = false;
							} else if (talentName === "Venomous Chain" && playerStats.TotalElementBlood < 75) {
								isEligible = false;
							} else if (talentName === "Heavy Disease" && playerStats.TotalElementBlood < 100) {
								isEligible = false;
							} else if (talentName === "Simple Manipulation: Unstable Blood" && (playerStats.TotalElementBlood < 50 || currentTalents["Manipulation Path: Agile Misery"] || currentTalents["Manipulation Path: Spirit Lantern"])) {
								isEligible = false;
							} else if (talentName === "Peaking Control" && playerStats.TotalElementBlood < 75) {
								isEligible = false;
							} else if (talentName === "Piercing Totality" && playerStats.TotalElementBlood < 100) {
								isEligible = false;
							} else if (talentName === "Blood Syphon" && (playerStats.TotalElementBlood < 40 || playerStats.TotalWillpower < 40)) {
								isEligible = false;
							} else if (talentName === "Not So Cheap Trick" && playerStats.TotalElementBlood < 25) {
								isEligible = false;
							} else if (talentName === "Harvest Season" && playerStats.TotalElementBlood < 25) {
								isEligible = false;
							} else if (talentName === "Payback" && (playerStats.TotalElementBlood < 40 || playerStats.TotalStrength < 25)) {
								isEligible = false;
							} else if (talentName === "Emerging Transfusion" && (playerStats.TotalElementBlood < 50 || playerStats.TotalStrength < 50)) {
								isEligible = false;
							} else if (talentName === "Sucker Strike" && playerStats.TotalElementBlood < 80) {
								isEligible = false;
							} else if (talentName === "Lose Your Mind" && playerStats.TotalStrength < 30) {
								isEligible = false;
							} else if (talentName === "Million Ton Piercer" && playerStats.TotalStrength < 90) {
								isEligible = false;
							} else if (talentName === "Ether Overdrive" && playerStats.TotalIntelligence < 90) {
								isEligible = false;
							} else if (talentName === "Foolish Outburst" && playerStats.TotalIntelligence < 50) {
								isEligible = false;
							} else if (talentName === "Dreambreaker" && playerStats.TotalStrength < 100) {
								isEligible = false;
							} else if (talentName === "Collapsed Lung" && playerStats.TotalStrength < 100) {
								isEligible = false;
							} else if (talentName === "Dreambreaker's Left" && playerStats.TotalStrength < 100) {
								isEligible = false;
							} else if (talentName === "Piercing Will" && playerStats.TotalWillpower < 80) {
								isEligible = false;
							} else if (talentName === "Unfazed" && playerStats.TotalWillpower < 50) {
								isEligible = false;
							} else if (talentName === "Grasp on Reality" && (playerStats.TotalWillpower < 5 || playerStats.TotalFortitude < 25)) {
								isEligible = false;
							} else if (talentName === "Disbelief" && playerStats.TotalWillpower < 25) {
								isEligible = false;
							} else if (talentName === "Speed Demon" && playerStats.TotalAgility < 25) {
								isEligible = false;
							} else if (talentName === "Blade Dancer" && playerStats.TotalAgility < 25) {
								isEligible = false;
							} else if (talentName === "Spine Cutter" && (playerStats.TotalStrength < 20 || playerStats.TotalAgility < 25)) {
								isEligible = false;
							} else if (talentName === "Murmer: Ardour" && (playerStats.TotalWillpower < 40 || playerStats.TotalStrength < 20)) {
								isEligible = false;
							} else if (talentName === "To the finish" && playerStats.TotalFortitude < 50) {
								isEligible = false;
							} else if (talentName === "Ether Absorption" && playerStats.TotalIntelligence < 15) {
								isEligible = false;
							} else if (talentName === "Eureka" && playerStats.TotalIntelligence < 30) {
								isEligible = false;
							} else if (talentName === "Overflowing Dam" && playerStats.TotalIntelligence < 40) {
								isEligible = false;
							} else if (talentName === "Twelve Steps Ahead" && playerStats.TotalIntelligence < 80) {
								isEligible = false;
							} else if (talentName === "Lord's Tithe" && (playerStats.TotalElementShadow < 40 || !hasMantra(playerStats.Mantras, "Reinforce"))) {
								isEligible = false;
							} else if (talentName === "Perfect Flash" && playerStats.TotalIntelligence < 20) {
								isEligible = false;
							} else if (talentName === "Charming Master" && playerStats.TotalCharisma < 90) {
								isEligible = false;
							} else if (talentName === "Master Flamecharmer" && playerStats.TotalElementFire < 50) {
								isEligible = false;
							} else if (talentName === "Master Bloodrender" && playerStats.TotalElementBlood < 50) {
								isEligible = false;
							} else if (talentName === "Master Earthbender" && playerStats.TotalElementEarth < 50) {
								isEligible = false;
							} else if (talentName === "Natural Disaster" && playerStats.TotalElementEarth < 50) {
								isEligible = false;
							} else if (talentName === "Memento Mori" && (playerStats.TotalElementEarth < 50 || playerStats.TotalWillpower < 20)) {
								isEligible = false;
							} else if (talentName === "Annihilator" && (playerStats.TotalElementEarth < 50 || playerStats.TotalStrength < 50)) {
								isEligible = false;
							} else if (talentName === "Battlefield Strategist" && playerStats.TotalElementEarth < 40) {
								isEligible = false;
							} else if (talentName === "Impermeable" && playerStats.TotalElementEarth < 80) {
								isEligible = false;
							} else if (talentName === "Solidifier" && playerStats.TotalElementEarth < 100) {
								isEligible = false;
							} else if (talentName === "Master Flamecharmer (Eruption)" && playerStats.TotalElementFire < 50) {
								isEligible = false;
							} else if (talentName === "Eruption Path: Lava Serpent" && playerStats.TotalElementFire < 50) {
								isEligible = false;
							} else if (talentName === "Molten Defense" && playerStats.TotalElementFire < 75) {
								isEligible = false;
							} else if (talentName === "Meteor Impact" && playerStats.TotalElementFire < 25) {
								isEligible = false;
							} else if (talentName === "Flash Point" && playerStats.TotalElementFire < 80) {
								isEligible = false;
							} else if (talentName === "Double Trouble" && playerStats.TotalElementFire < 100) {
								isEligible = false;
							} else if (talentName === "The Final Act" && playerStats.TotalElementFire < 75) {
								isEligible = false;
							} else if (talentName === "Emperor Flame" && playerStats.TotalElementFire < 80) {
								isEligible = false;
							} else if (talentName === "Flamewalker" && (playerStats.TotalElementFire < 40 || playerStats.TotalAgility < 25)) {
								isEligible = false;
							} else if (talentName === "Warding Radiance" && (playerStats.TotalAgility < 20 || playerStats.TotalElementFire < 30)) {
								isEligible = false;
							} else if (talentName === "Azure Flames" && (playerStats.TotalWillpower < 40 || playerStats.TotalElementFire < 75)) {
								isEligible = false;
							} else if (talentName === "Explosive Flourish" && playerStats.TotalElementFire < 50) {
								isEligible = false;
							} else if (talentName === "Flaming Flourish" && playerStats.TotalElementFire < 25) {
								isEligible = false;
							} else if (talentName === "Master Frostdrawer" && playerStats.TotalElementIce < 50) {
								isEligible = false;
							} else if (talentName === "Master Frostdrawer (Crystallization)" && playerStats.TotalElementIce < 50) {
								isEligible = false;
							} else if (talentName === "Glass Path: Crystallization" && playerStats.TotalElementIce < 40) {
								isEligible = false;
							} else if (talentName === "Crystal Shrapnel" && playerStats.TotalElementIce < 60) {
								isEligible = false;
							} else if (talentName === "Volcanic Glass" && playerStats.TotalElementIce < 40) {
								isEligible = false;
							} else if (talentName === "Reclaimed Glass" && playerStats.TotalElementIce < 65) {
								isEligible = false;
							} else if (talentName === "Temperature Shock" && (playerStats.TotalElementIce < 40 || playerStats.TotalElementFire < 40)) {
								isEligible = false;
							} else if (talentName === "Cold Heart" && playerStats.TotalElementIce < 75) {
								isEligible = false;
							} else if (talentName === "Cryostasis" && playerStats.TotalElementIce < 80) {
								isEligible = false;
							} else if (talentName === "Chilling Flourish" && playerStats.TotalElementIce < 50) {
								isEligible = false;
							} else if (talentName === "Unyielding Frost" && playerStats.TotalElementIce < 75) {
								isEligible = false;
							} else if (talentName === "Master Galebreather" && playerStats.TotalElementWind < 50) {
								isEligible = false;
							} else if (talentName === "Master Galebreather (Ember)" && playerStats.TotalElementWind < 50) {
								isEligible = false;
							} else if (talentName === "Scorched Path: Ember" && (playerStats.TotalElementFire < 55 || playerStats.TotalElementWind < 55)) {
								isEligible = false;
							} else if (talentName === "Burning Lungs" && (playerStats.TotalElementWind < 65 || playerStats.TotalElementFire < 65)) {
								isEligible = false;
							} else if (talentName === "Emberlink" && (playerStats.TotalElementWind < 101 || playerStats.TotalElementFire < 101)) {
								isEligible = false;
							} else if (talentName === "Wind Step" && playerStats.TotalElementWind < 40) {
								isEligible = false;
							} else if (talentName === "Air Pressure" && (playerStats.TotalElementWind < 50 || playerStats.TotalAgility < 20)) {
								isEligible = false;
							} else if (talentName === "Master Galebreather (Specter)" && playerStats.TotalElementWind < 50) {
								isEligible = false;
							} else if (talentName === "Haunted Gale" && playerStats.TotalElementWind < 40) {
								isEligible = false;
							} else if (talentName === "Haunted Path: Specter" && playerStats.TotalElementWind < 50) {
								isEligible = false;
							} else if (talentName === "Spectral Shift" && playerStats.TotalElementWind < 75) {
								isEligible = false;
							} else if (talentName === "A World Without Song" && playerStats.TotalElementWind < 75) {
								isEligible = false;
							} else if (talentName === "Suffocating Flourish" && playerStats.TotalElementWind < 50) {
								isEligible = false;
							} else if (talentName === "Master Thundercaller" && playerStats.TotalElementLightning < 50) {
								isEligible = false;
							} else if (talentName === "Electrocution" && playerStats.TotalElementLightning < 50) {
								isEligible = false;
							} else if (talentName === "Raiton Path: Enlightened" && playerStats.TotalElementLightning < 50) {
								isEligible = false;
							} else if (talentName === "Unipolar Path: Teslafication" && (playerStats.TotalElementLightning < 50 || playerStats.TotalElementIron < 50)) {
								isEligible = false;
							} else if (talentName === "Wraith Path: Umbra" && (playerStats.TotalElementFire < 50 || playerStats.TotalElementShadow < 50)) {
								isEligible = false;
							} else if (talentName === "Unipolar Conductivity" && playerStats.TotalElementIron < 75) {
								isEligible = false;
							} else if (talentName === "Decaying Posture" && playerStats.TotalElementIron < 75) {
								isEligible = false;
							} else if (talentName === "Oxidizing Blitz" && playerStats.TotalElementIron < 100) {
								isEligible = false;
							} else if (talentName === "Decay Path: Oxidize" && playerStats.TotalElementIron < 50) {
								isEligible = false;
							} else if (talentName === "Melted Wire" && playerStats.TotalElementLightning < 80) {
								isEligible = false;
							} else if (talentName === "Raiton's Charge" && playerStats.TotalElementLightning < 75) {
								isEligible = false;
							} else if (talentName === "Short Circuit" && playerStats.TotalElementLightning < 75) {
								isEligible = false;
							} else if (talentName === "Scatter" && playerStats.TotalElementLightning < 50) {
								isEligible = false;
							} else if (talentName === "Overload" && playerStats.TotalElementLightning < 100) {
								isEligible = false;
							} else if (talentName === "Master Shadowcaster" && playerStats.TotalElementShadow < 50) {
								isEligible = false;
							} else if (talentName === "There Shall Be No Light" && playerStats.TotalElementShadow < 100) {
								isEligible = false;
							} else if (talentName === "Common State of Inner Violence" && playerStats.TotalElementShadow < 75) {
								isEligible = false;
							} else if (talentName === "Empty Shell" && playerStats.TotalElementShadow < 50) {
								isEligible = false;
							} else if (talentName === "Dark Synergy" && playerStats.TotalElementShadow < 25) {
								isEligible = false;
							} else if (talentName === "Master Ironsinger" && playerStats.TotalElementIron < 50) {
								isEligible = false;
							} else if (talentName === "Armor Synergy" && playerStats.TotalElementIron < 50) {
								isEligible = false;
							} else if (talentName === "An Ironsinger's Instinct" && playerStats.TotalElementIron < 75) {
								isEligible = false;
							} else if (talentName === "Metal Drain" && playerStats.TotalElementIron < 80) {
								isEligible = false;
							} else if (talentName === "Metal Eater" && playerStats.TotalElementIron < 80) {
								isEligible = false;
							} else if (talentName === "Alloyblood" && playerStats.TotalElementIron < 100) {
								isEligible = false;
							} else if (talentName === "Speed Emission" && playerStats.TotalAgility < 25) {
								isEligible = false;
							} else if (talentName === "Armor Conserver" && playerStats.Level < 8) {
								isEligible = false;
							} else if (talentName === "Frozen Pin-Cushion" && (playerStats.TotalElementIce < 60 || !hasMantra(playerStats.Mantras, "Ice Daggers"))) {
								isEligible = false;
							} else if (talentName === "Flash Pressure" && !hasMantra(playerStats.Mantras, "Breeze Blitz")) {
								isEligible = false;
							} else if (talentName === "Blood Path: True Frost" && (playerStats.TotalElementBlood < 20 || playerStats.TotalElementIce < 10)) {
								isEligible = false;
							} else if (talentName === "Agile Path: Pressured Blood" && playerStats.TotalElementBlood < 15) {
								isEligible = false;
							} else if (talentName === "Bleeding Fighter" && (playerStats.TotalElementBlood < 999 || playerStats.TotalStrength < 999)) {
								isEligible = false;
							}
			
							if (isEligible && !currentTalents[talentName]) {
								const rarity = talentData.InnateRarity === "Legendary" ? "Advanced" : talentData.InnateRarity || "Common";
								const className = talentData.Class || "Miscellaneous";
			
								if (!groupedTalents[rarity][className]) {
									groupedTalents[rarity][className] = [];
								}
			
								groupedTalents[rarity][className].push({
									name: talentName,
									desc: talentData.Desc,
									icon: talentData.Icon || "https://deepwoken.co/newicon.png", // Ensure fallback is applied
									rarity: rarity
								});
							}
						}
			
						populateDropdown('Advanced-dropdown', groupedTalents.Advanced, 'Advanced');
						populateDropdown('Rare-dropdown', groupedTalents.Rare, 'Rare');
						populateDropdown('Common-dropdown', groupedTalents.Common, 'Common');
					}
			
					function populateDropdown(dropdownId, talentsByClass, rarity) {
						const dropdown = document.getElementById(dropdownId);
						if (!dropdown) return;
			
						dropdown.innerHTML = '';
			
						for (const [className, talents] of Object.entries(talentsByClass)) {
							const fieldset = document.createElement('fieldset');
							fieldset.className = 'svelte-hwcpcr';
			
							const legend = document.createElement('legend');
							legend.className = 'svelte-hwcpcr';
							legend.textContent = className;
							fieldset.appendChild(legend);
			
							talents.forEach(talent => {
								const talentDiv = document.createElement('div');
								talentDiv.className = `talent ${rarity} shrine-false locked-false svelte-hwcpcr`;
								talentDiv.setAttribute('role', 'button');
								talentDiv.setAttribute('tabindex', '0');
								talentDiv.style.userSelect = 'none';
								talentDiv.style.touchAction = 'auto';
								talentDiv.dataset.talentName = talent.name;
			
								// Debug log to check icon value
								console.log(`Talent: ${talent.name}, Icon: ${talent.icon}`);
			
								talentDiv.innerHTML = `
									${talent.name}
									<div class="svelte-hwcpcr" style="display: flex; gap: 4px;">
										<img class="icon svelte-hwcpcr" title="${talent.desc}" width="14" height="14" alt="new" src="${talent.icon}">
									</div>
								`;
			
								talentDiv.addEventListener('click', () => {
									if (!currentTalents[talent.name]) {
										currentTalents[talent.name] = true;
										console.log("Talent selected:", talent.name);
										console.log("Current talents:", JSON.stringify(currentTalents, null, 2));
										populateObtainedTalents(currentTalents, talentsData);
										populateDropdowns(talentsData, currentTalents, updatePlayerStats());
									}
								});
			
								fieldset.appendChild(talentDiv);
							});
			
							dropdown.appendChild(fieldset);
						}
			
						if (dropdown.innerHTML.trim() === '') {
							const noTalentsDiv = document.createElement('div');
							noTalentsDiv.className = 'talent svelte-hwcpcr';
							noTalentsDiv.textContent = 'No talents :(';
							dropdown.appendChild(noTalentsDiv);
						}
					}
			
					function populateObtainedTalents(currentTalents, talentsData) {
						const obtainedTalentsContainer = document.querySelector('#rollable-talent-2 .talents-container');
						if (!obtainedTalentsContainer) return;
			
						obtainedTalentsContainer.innerHTML = '';
			
						const groupedObtainedTalents = {};
						for (const [talentName] of Object.entries(currentTalents)) {
							if (talentsData[talentName]) {
								const className = talentsData[talentName].Class || "Miscellaneous";
								const rarity = talentsData[talentName].InnateRarity === "Legendary" ? "Advanced" : talentsData[talentName].InnateRarity || "Common";
								if (!groupedObtainedTalents[className]) {
									groupedObtainedTalents[className] = [];
								}
								groupedObtainedTalents[className].push({
									name: talentName,
									desc: talentsData[talentName].Desc,
									icon: "https://deepwoken.co/newicon.png", // Always use this URL
									rarity: rarity
								});
							} else {
								console.warn("⚠️ Talent not found in talentsData:", talentName);
							}
						}
			
						const sortedClasses = Object.keys(groupedObtainedTalents).sort();
			
						sortedClasses.forEach(className => {
							const fieldset = document.createElement('fieldset');
							fieldset.className = 'svelte-hwcpcr';
			
							const legend = document.createElement('legend');
							legend.className = 'svelte-hwcpcr';
							legend.textContent = className;
							fieldset.appendChild(legend);
			
							groupedObtainedTalents[className].forEach(talent => {
								const talentDiv = document.createElement('div');
								talentDiv.className = `talent ${talent.rarity} svelte-hwcpcr`; // Match the dropdown's class structure
								talentDiv.style.userSelect = 'none';
								talentDiv.style.touchAction = 'auto';
								talentDiv.dataset.talentName = talent.name;
			
								talentDiv.innerHTML = `
									${talent.name}
									<div class="svelte-hwcpcr" style="display: flex; gap: 4px;">
										<img class="icon svelte-hwcpcr" title="${talent.desc}" width="14" height="14" alt="new" src="${talent.icon}">
									</div>
								`;
			
								// Undo functionality
								talentDiv.addEventListener('click', () => {
									delete currentTalents[talent.name];
									console.log("Talent removed:", talent.name);
									console.log("Current talents:", JSON.stringify(currentTalents, null, 2));
									populateObtainedTalents(currentTalents, talentsData);
									populateDropdowns(talentsData, currentTalents, updatePlayerStats());
								});
			
								fieldset.appendChild(talentDiv);
							});
			
							obtainedTalentsContainer.appendChild(fieldset);
						});
			
						const obtainedCount = Object.keys(currentTalents).length;
						const obtainedCountElement = document.querySelector('#rollable-talent-2 .svelte-hwcpcr:nth-child(2) b:first-child');
						if (obtainedCountElement) obtainedCountElement.textContent = obtainedCount;
			
						const rareCount = Object.entries(currentTalents).filter(([name]) => talentsData[name]?.InnateRarity === "Rare").length;
						const advancedCount = Object.entries(currentTalents).filter(([name]) => talentsData[name]?.InnateRarity === "Legendary").length;
						const rareCountElement = document.querySelector('#rollable-talent-2 .Rare:nth-child(2)');
						const advancedCountElement = document.querySelector('#rollable-talent-2 .Advanced:nth-child(2)');
			
						console.log("Obtained count:", obtainedCount);
						console.log("Rare count:", rareCount);
						console.log("Advanced count:", advancedCount);
			
						if (rareCountElement) rareCountElement.textContent = rareCount;
						if (advancedCountElement) advancedCountElement.textContent = advancedCount;
					}
				});
			</script>
        <button id="exportdeep" href="javascript:void(0);"class="function-button border-thin svelte-g2d5k9" data-svelte-h="svelte-oiyxom"><div><b class="svelte-g2d5k9">Export</b> to the deep</div></button>  </div>
		<script>
			document.getElementById('exportdeep').addEventListener('click', function() {
				const statsMapping = {
					st: 'Strength',
					pe: 'Precision',
					fo: 'Fortitude',
					ag: 'Agility',
					in: 'Intelligence',
					wi: 'Willpower',
					ch: 'Charisma',
					he: 'Heavy Wep.',
					me: 'Medium Wep.',
					li: 'Light Wep.',
					fl: 'Flamecharm',
					fr: 'Frostdraw',
					th: 'Thundercall',
					ga: 'Galebreathe',
					sh: 'Shadowcast',
					ir: 'Ironsing',
					bl: 'Bloodrend',
					eb: 'Earthbend'
				};
			
				// Collect stats
				const stats = {};
				Object.keys(statsMapping).forEach(key => {
					const input = document.querySelector(`input[statname="${statsMapping[key]}"]`);
					stats[key] = input ? input.value || 0 : 0;
				});
			
				// Get build name & description
				const buildName = document.getElementById('build-name')?.value.trim() || "Unnamed Build";
				const buildDesc = document.getElementById('build-description')?.textContent.trim() || "No description.";
			
				// Get race name
				const raceSelect = document.querySelector('select[statname="Race"]');
				const race = raceSelect ? raceSelect.options[raceSelect.selectedIndex].text : "Unknown Race";
			
				// Get oath name
				const oathSelect = document.querySelector('select[statname="Oath"]');
				const oath = oathSelect ? oathSelect.options[oathSelect.selectedIndex].text : "Oathless";
			
				// Power Calculation (using your logic)
				const totalBuildPoints = 505 - 105;
				const NON_ATTUNEMENT_FREE = 15;
				const HIGHEST_ATTUNEMENT_FREE = 10;
				const OTHER_ATTUNEMENT_FREE = 5;
			
				function calculateNonAttunementCost() {
					let allocated = 0;
					document.querySelectorAll('input.stat-input[stattype="base"]').forEach(input => {
						allocated += parseInt(input.value) || 0;
					});
					return allocated > NON_ATTUNEMENT_FREE ? allocated - NON_ATTUNEMENT_FREE : 0;
				}
			
				function calculateWeaponCost() {
					let cost = 0;
					document.querySelectorAll('input.stat-input[stattype="weapon"]').forEach(input => {
						cost += parseInt(input.value) || 0;
					});
					return cost;
				}
			
				function calculateAttunementCost() {
					const values = [];
					document.querySelectorAll('input.stat-input[stattype="attunement"]').forEach(input => {
						values.push(parseInt(input.value) || 0);
					});
					if (values.length === 0) return 0;
					const maxValue = Math.max(...values);
					let cost = 0;
					document.querySelectorAll('input.stat-input[stattype="attunement"]').forEach(input => {
						let value = parseInt(input.value) || 0;
						let freeThreshold = OTHER_ATTUNEMENT_FREE;
						if (value === maxValue && value >= HIGHEST_ATTUNEMENT_FREE) {
							freeThreshold = HIGHEST_ATTUNEMENT_FREE;
						}
						cost += value < freeThreshold ? value : (value - freeThreshold);
					});
					return cost;
				}
			
				function calculateMetaCost() {
					let cost = 0;
					document.querySelectorAll('input.stat-input[stattype="meta"]').forEach(input => {
						if (input.type === 'checkbox') {
							cost += input.checked ? 1 : 0;
						} else if (input.type === 'select-one' || input.tagName === 'SELECT') {
							cost += parseInt(input.value) || 0;
						} else {
							cost += parseInt(input.value) || 0;
						}
					});
					return cost;
				}
			
				// Compute total cost
				const totalCost = calculateNonAttunementCost() + calculateWeaponCost() + calculateAttunementCost() + calculateMetaCost();
			
				// Compute power level
				let powerLevel = Math.min(Math.floor(totalCost / (totalBuildPoints / 80)), 80);
			
				// Build formatted output
				const output = `
${buildName}, The ${oath} | ${buildDesc}
=====
LVL ${powerLevel} ${race}
==ATTRIBUTES==
${stats.st} Strength; ${stats.pe} Precision; ${stats.fo} Fortitude; ${stats.ag} Agility; ${stats.in} Intelligence; ${stats.wi} Willpower; ${stats.ch} Charisma
=====
${stats.he} Heavy Weapon; ${stats.me} Medium Weapon; ${stats.li} Light Weapon
=====
${stats.fl} Flamecharm; ${stats.fr} Frostdraw; ${stats.th} Thunder; ${stats.ga} Gale; ${stats.sh} Shadowcast; ${stats.ir} Ironsing; ${stats.bl} Bloodrend; ${stats.eb} Earthbend
				`.trim();
			
				// Copy to clipboard
				navigator.clipboard.writeText(output).then(() => {
					alert('Build copied in Deepwoken format!');
				}).catch(err => {
					console.error('Could not copy build to clipboard:', err);
				});
			});
			</script>
			
		 </script>
		<div class="functions grid-item svelte-g2d5k9" ignore-in-export="">
            <a id="loadBuildButton" class="function-button overworld border-thin svelte-g2d5k9">Load Build</a>
        
            <div id="importWrapper" class="wrapper svelte-1q5srmm" style="max-width: 475px; width: 50vw; display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 1000; text-align: center;">
                <textarea id="importDeepwokenData" placeholder="Paste your Deepwoken build here... Click 'Import build from Deepwoken' again to close this window." class="svelte-1q5srmm"></textarea>
                <button id="importBuildButton" class="function-button overworld border-thin svelte-1q5srmm">Import</button>
            </div>
            
            <script>
                document.getElementById('loadBuildButton').addEventListener('click', function() {
                    const importWrapper = document.getElementById('importWrapper');
                    
                    // Toggle display
                    if (importWrapper.style.display === 'none' || importWrapper.style.display === '') {
                        importWrapper.style.display = 'block';
                    } else {
                        importWrapper.style.display = 'none';
                    }
                });
            
                document.addEventListener('DOMContentLoaded', function() {
                    const statsMapping = {
                        st: 'Strength',
                        pe: 'Precision',
                        fo: 'Fortitude',
                        ag: 'Agility',
                        in: 'Intelligence',
                        wi: 'Willpower',
                        ch: 'Charisma',
                        he: 'Heavy Wep.',
                        me: 'Medium Wep.',
                        li: 'Light Wep.',
                        fl: 'Flamecharm',
                        fr: 'Frostdraw',
                        th: 'Thundercall',
                        ga: 'Galebreathe',
                        sh: 'Shadowcast',
                        ir: 'Ironsing',
                        bl: 'Bloodrend',
                        eb: 'Earthbend',
                        ra: 'Race',
                        oa: 'Oath',
                        mu: 'Murmur',
                        be: 'Bell'
                    };
            
                    const importBuildButton = document.getElementById('importBuildButton');
                    const textarea = document.getElementById('importDeepwokenData');
                    const importWrapper = document.getElementById('importWrapper');
            
                    // Import build data
                    importBuildButton.addEventListener('click', function() {
                        const buildData = textarea.value;
                        const regex = /([a-z]+)\/(\d+)/g;
                        let match;
                        while ((match = regex.exec(buildData)) !== null) {
                            const statKey = match[1];
                            const statValue = match[2];
            
                            // Find the corresponding statname element (input or select)
                            const statName = statsMapping[statKey];
                            const input = document.querySelector(`input[statname="${statName}"]`);
                            const select = document.querySelector(`select[statname="${statName}"]`);
            
                            if (input) {
                                input.value = statValue;
                                input.dispatchEvent(new Event('input')); // Trigger input event to update stats
                            } else if (select) {
                                select.value = statValue;
                                select.dispatchEvent(new Event('input')); // Trigger input event to update stats
                            }
                        }
            
                        alert('Build Imported Successfully!');
            
                        // Close the modal after import
                        importWrapper.style.display = 'none';
                    });
                });
            </script>
            
         <hr style="width: 100%"> <a target="_blank" rel="noreferrer" style="display: flex; align-items: center; justify-content: center" href="https://discord.gg/vMBHH8BkDC" class="function-button border-thin discord svelte-g2d5k9" data-svelte-h="svelte-lbpxpy"><img src="https://deepwoken.co/discord.png" alt="discord icon" style="color: white; width: 16px; height: 16px; margin-right: 5px"> Deepwoken Modded</a>  
         <button class="function-button border-thin encouragement svelte-g2d5k9" id="importdiddy" data-svelte-h="svelte-nlojkb">❤ Had a tough day?</button>

         <script>
            document.getElementById('importdiddy').addEventListener('click', function() {
                const buildData = "st/90/pe/60/fo/90/ag/25/in/40/wi/0/ch/25/he/85/me/0/li/0/fl/0/fr/0/th/0/ga/0/sh/0/ir/0/bl/0/eb/0/ra/17/oa/8/mu/1/be/2";
                
                const statsMapping = {
                    st: 'Strength',
                    pe: 'Precision',
                    fo: 'Fortitude',
                    ag: 'Agility',
                    in: 'Intelligence',
                    wi: 'Willpower',
                    ch: 'Charisma',
                    he: 'Heavy Wep.',
                    me: 'Medium Wep.',
                    li: 'Light Wep.',
                    fl: 'Flamecharm',
                    fr: 'Frostdraw',
                    th: 'Thundercall',
                    ga: 'Galebreathe',
                    sh: 'Shadowcast',
                    ir: 'Ironsing',
                    bl: 'Bloodrend',
                    eb: 'Earthbend',
                    ra: 'Race',
                    oa: 'Oath',
                    mu: 'Murmur',
                    be: 'Bell'
                };
        
                // Parse the build data string into an object
                const parsedBuild = {};
                const regex = /([a-z]+)\/(\d+)/g;
                let match;
                while ((match = regex.exec(buildData)) !== null) {
                    parsedBuild[match[1]] = match[2];
                }
        
                // Set the input values based on the parsed data
                Object.keys(parsedBuild).forEach(key => {
                    const statName = statsMapping[key];
                    
                    // Check for input or select elements
                    const input = document.querySelector(`input[statname="${statName}"]`);
                    const select = document.querySelector(`select[statname="${statName}"]`);
        
                    if (input) {
                        input.value = parsedBuild[key];
                        input.dispatchEvent(new Event('input')); // Trigger input event to update stats
                    } else if (select) {
                        select.value = parsedBuild[key];
                        select.dispatchEvent(new Event('input')); // Trigger input event to update stats
                    }
                });
        
                alert('Hope this makes your day better! <3');
            });
        </script>
        
		 <div class="wrapper svelte-1q5srmm" style="max-width: 475px; width: 50vw; display: none"><textarea id="importDeepwokenData" placeholder="Paste your Deepwoken build here... Click 'Import build from Deepwoken' again to close this window." class="svelte-1q5srmm"></textarea> <button class="function-button overworld border-thin svelte-1q5srmm" data-svelte-h="svelte-1k0lp5h">Import</button> </div>
	  </div>
	  <div class="container svelte-hwcpcr" id="Talents" role="button" tabindex="0">
		 <div class="grid-item rollable-talents svelte-hwcpcr" id="rollable-talent-1">
			<div style="text-align: center" class="svelte-hwcpcr"><b class="svelte-hwcpcr" data-svelte-h="svelte-148zqj2">Obtainable Talents</b> <i style="color: gray" class="svelte-hwcpcr">0</i></div>
			<div style="display: flex; justify-content: space-around" class="svelte-hwcpcr"><b class=" svelte-hwcpcr">0</b> <b class="Rare svelte-hwcpcr">0</b> <b class="Advanced svelte-hwcpcr">0</b></div>
			<input type="text" placeholder="Search talents..." aria-autocomplete="none" class="svelte-hwcpcr" value="">   <button class="filters-display off svelte-hwcpcr" data-svelte-h="svelte-118qp2v">Filters</button> 
			<div class="filters svelte-hwcpcr" style="display: none"><button class="filter pre false svelte-hwcpcr" tabindex="0">PRE  <img class="icon svelte-hwcpcr" title="This talent is only obtainable pre-shrine." width="14" height="14" alt="new" src="shrineicon.png" style="margin-left: 3px"> </button><button class="filter post false svelte-hwcpcr" tabindex="0">POST   </button><button class="filter fav false svelte-hwcpcr" tabindex="0">FAV <img class="icon svelte-hwcpcr" title="This talent was favorited by the build's creator!" width="14" height="14" alt="new" src="lovedicon.png" style="margin-left: 3px">  </button><button class="filter str false svelte-hwcpcr" tabindex="0">STR  </button><button class="filter agi false svelte-hwcpcr" tabindex="0">AGI  </button><button class="filter ftd false svelte-hwcpcr" tabindex="0">FTD  </button><button class="filter int false svelte-hwcpcr" tabindex="0">INT  </button><button class="filter wil false svelte-hwcpcr" tabindex="0">WIL  </button><button class="filter cha false svelte-hwcpcr" tabindex="0">CHA  </button><button class="filter attunement false svelte-hwcpcr" tabindex="0">ATTUNEMENT  </button></div>
			<div id="Advanced-dropdown-button" active="true" class="Advanced rarity svelte-hwcpcr" role="button" tabindex="0">
			   <b class="svelte-hwcpcr">Advanced</b> 
			   <div style="color:white" id="Advanced-dropdown-icon" class="svelte-hwcpcr">▾</div>
			</div>
			<div id="Advanced-dropdown" class="talents-container svelte-hwcpcr">
			   <div class="talent svelte-hwcpcr" data-svelte-h="svelte-1yuze5x">No talents :(</div>
			</div>
			<div id="Rare-dropdown-button" active="true" class="Rare rarity svelte-hwcpcr" role="button" tabindex="0">
			   <b class="svelte-hwcpcr">Rare</b> 
			   <div style="color:white" id="Rare-dropdown-icon" class="svelte-hwcpcr">▾</div>
			</div>
			<div id="Rare-dropdown" class="talents-container svelte-hwcpcr">
			   <div class="talent svelte-hwcpcr" data-svelte-h="svelte-1yuze5x">No talents :(</div>
			</div>
			<div id="Common-dropdown-button" active="true" class="Common rarity svelte-hwcpcr" role="button" tabindex="0">
			   <b class="svelte-hwcpcr">Common</b> 
			   <div style="color:white" id="Common-dropdown-icon" class="svelte-hwcpcr">▾</div>
			</div>
			<div id="Common-dropdown" class="talents-container svelte-hwcpcr">
			   <div class="talent svelte-hwcpcr" data-svelte-h="svelte-1yuze5x">No talents :(</div>
			</div>
			<div id="Oath-dropdown-button" active="true" class="Oath rarity svelte-hwcpcr" role="button" tabindex="0">
			   <b class="svelte-hwcpcr">Oath</b> 
			   <div style="color:white" id="Oath-dropdown-icon" class="svelte-hwcpcr">▾</div>
			</div>
			<div id="Oath-dropdown" class="talents-container svelte-hwcpcr">
			   <div class="talent svelte-hwcpcr" data-svelte-h="svelte-1yuze5x">No talents :(</div>
			</div>
			<div id="Quest-dropdown-button" active="true" class="Quest rarity svelte-hwcpcr" role="button" tabindex="0">
			   <b class="svelte-hwcpcr">Quest</b> 
			   <div style="color:white" id="Quest-dropdown-icon" class="svelte-hwcpcr">▾</div>
			</div>
			<div id="Quest-dropdown" class="talents-container svelte-hwcpcr">
			   <div class="talent svelte-hwcpcr" data-svelte-h="svelte-1yuze5x">No talents :(</div>
			</div>
			<div id="Murmur-dropdown-button" active="true" class="Murmur rarity svelte-hwcpcr" role="button" tabindex="0">
			   <b class="svelte-hwcpcr">Murmur</b> 
			   <div style="color:white" id="Murmur-dropdown-icon" class="svelte-hwcpcr">▾</div>
			</div>
			<div id="Murmur-dropdown" class="talents-container svelte-hwcpcr">
			   <div class="talent svelte-hwcpcr" data-svelte-h="svelte-1yuze5x">No talents :(</div>
			</div>
		 </div>
		 <div class="grid-item obtained-talents svelte-hwcpcr" id="rollable-talent-2">
			<div style="text-align: center" class="svelte-hwcpcr"><b class="svelte-hwcpcr" data-svelte-h="svelte-17jxel1">Obtained Talents</b> <i style="color: gray" class="svelte-hwcpcr">0</i></div>
			<div style="display: flex; justify-content: space-around" class="svelte-hwcpcr"><b class=" svelte-hwcpcr">0</b> <b class="Rare svelte-hwcpcr">0</b> <b class="Advanced svelte-hwcpcr">0</b></div>
			<div style="text-align: center; font-size: 12px; color: rgba(0, 0, 0, 0.5)" class="svelte-hwcpcr">Max of <b class="svelte-hwcpcr">76</b> talents, <b class="svelte-hwcpcr" data-svelte-h="svelte-1fec9zz">50</b> rollable
			   (<b class="Rare svelte-hwcpcr">40</b> guaranteed rare attempts) and
			   <b class="svelte-hwcpcr">24</b> from Roll 2
			</div>
			<div style="display: flex; flex-direction: row; align-items: center; gap: 5px" class="svelte-hwcpcr"><input type="text" placeholder="Search talents..." aria-autocomplete="none" class="svelte-hwcpcr" value=""> <img src="alphabetical.png" alt="sort" width="14" height="14" style="cursor: pointer; filter: invert(50%)" class="svelte-hwcpcr"> <img src="check.png" alt="compare" width="14" height="14" style="cursor: pointer;" class="svelte-hwcpcr"></div>
			<button class="filters-display off svelte-hwcpcr" data-svelte-h="svelte-118qp2v">Filters</button> 
			<div class="filters svelte-hwcpcr" style="display: none"><button class="filter pre false svelte-hwcpcr" tabindex="0">PRE  <img class="icon svelte-hwcpcr" title="This talent is only obtainable pre-shrine." width="14" height="14" alt="new" src="shrineicon.png" style="margin-left: 3px"> </button><button class="filter post false svelte-hwcpcr" tabindex="0">POST   </button><button class="filter fav false svelte-hwcpcr" tabindex="0">FAV <img class="icon svelte-hwcpcr" title="This talent was favorited by the build's creator!" width="14" height="14" alt="new" src="lovedicon.png" style="margin-left: 3px">  </button><button class="filter str false svelte-hwcpcr" tabindex="0">STR  </button><button class="filter agi false svelte-hwcpcr" tabindex="0">AGI  </button><button class="filter ftd false svelte-hwcpcr" tabindex="0">FTD  </button><button class="filter int false svelte-hwcpcr" tabindex="0">INT  </button><button class="filter wil false svelte-hwcpcr" tabindex="0">WIL  </button><button class="filter cha false svelte-hwcpcr" tabindex="0">CHA  </button><button class="filter attunement false svelte-hwcpcr" tabindex="0">ATTUNEMENT  </button></div>
			<div id="" class="talents-container svelte-hwcpcr" style="display: flex; margin-top: 10px">
			   <div class="talent svelte-hwcpcr" data-svelte-h="svelte-134h4x0">You can click on the talents to pick them!</div>
			</div>
		 </div>
	  </div>
	  <div class="wrapper svelte-1huhgdq" style="max-width: 475px; width: 50vw; display: none">
		 <textarea id="importTalentsData" placeholder="Paste your Deepwoken build here to compare talents... Click the compare button again to close this window." class="svelte-1huhgdq"></textarea>
		 <div class="button-group svelte-1huhgdq"><button class="function-button overworld border-thin svelte-1huhgdq" data-svelte-h="svelte-15q1f6z">Compare Talents</button> <button class="function-button border-thin svelte-1huhgdq" data-svelte-h="svelte-17pqso8">Close</button></div>
	  </div>
	  <div class="container svelte-15yl2qu" id="Mantras">
		 <div class="grid-item rollable-mantras svelte-15yl2qu" id="rollable-mantra-1">
			<div style="text-align: center" class="svelte-15yl2qu" data-svelte-h="svelte-1y0ri92"><b class="svelte-15yl2qu">Obtainable Mantras</b></div>
			<div id="" class="mantras-container svelte-15yl2qu" style="display: flex; margin-top: 10px">
			   <div class="mantra-category svelte-15yl2qu">
				  <fieldset class="svelte-15yl2qu">
					 <legend class="svelte-15yl2qu">Combat</legend>
				  </fieldset>
			   </div>
			   <div class="mantra-category svelte-15yl2qu">
				  <fieldset class="svelte-15yl2qu">
					 <legend class="svelte-15yl2qu">Mobility</legend>
				  </fieldset>
			   </div>
			   <div class="mantra-category svelte-15yl2qu">
				  <fieldset class="svelte-15yl2qu">
					 <legend class="svelte-15yl2qu">Support</legend>
				  </fieldset>
			   </div>
			   <div class="mantra-category svelte-15yl2qu">
				  <fieldset class="svelte-15yl2qu">
					 <legend class="svelte-15yl2qu">Wisp</legend>
				  </fieldset>
			   </div>
			</div>
		 </div>
		 <div class="obtained-mantras svelte-15yl2qu">
			<div class="grid-item svelte-15yl2qu" id="rollable-mantra-2">
			   <div style="text-align: center" class="svelte-15yl2qu" data-svelte-h="svelte-stygxh"><b class="svelte-15yl2qu">Obtained Mantras</b></div>
			   <div id="" class="mantras-container svelte-15yl2qu" style="display: flex; margin-top: 10px">
				  <div class="mantra svelte-15yl2qu" data-svelte-h="svelte-rm3f6q">You can click on the mantras to pick them!</div>
			   </div>
			</div>
			<div class="grid-item mantra-details svelte-15yl2qu">
			   <div style="font-size: 15px; margin: 10px;" class="svelte-15yl2qu" data-svelte-h="svelte-1eable2">Hold click on a mantra to view it's modifications.</div>
			</div>
		 </div>
	  </div>
	  <div class="container svelte-thvrgb" id="Weapons">
		 <div class="grid-item weapon-damage svelte-thvrgb" style="grid-column: 1 / span 5">
			<div class="text-input space svelte-thvrgb">
			   <label data-svelte-h="svelte-ar6yc7"><b>Weapon:</b></label> 
			   <div>
				  <select autocomplete="false" class="svelte-thvrgb">
					 <option value="0" data-svelte-h="svelte-1eftyhu">0</option>
					 <option value="1" data-svelte-h="svelte-qlj2sf">1</option>
					 <option value="2" data-svelte-h="svelte-1t43t20">2</option>
					 <option value="3" data-svelte-h="svelte-166med9">3</option>
				  </select>
				  Stars
				  <select autocomplete="false" class="svelte-thvrgb">
					 <option value="DMG%" data-svelte-h="svelte-1u7f21v">DMG%</option>
					 <option value="PEN%" data-svelte-h="svelte-3hfsja">PEN%</option>
					 <option value="WGT%" data-svelte-h="svelte-bs7jp5">WGT%</option>
				  </select>
			   </div>
			   <input type="text" class="inline-input svelte-thvrgb" list="weapons" id="weapon-input" onmouseover="focus()" autocomplete="false" value=""> 
			   <datalist id="weapons"></datalist>
			</div>
			<div class="text-input space svelte-thvrgb">
			   <label data-svelte-h="svelte-1tpebdq"><b>Enchant:</b></label> <input type="text" class="inline-input svelte-thvrgb" list="enchants" id="enchants-input" onmouseover="focus()" autocomplete="false" value=""> 
			   <datalist id="enchants"></datalist>
			</div>
			<div class="text-input space svelte-thvrgb">
			   <label data-svelte-h="svelte-1oy9uq4"><b>Motif:</b></label> <input type="text" class="inline-input svelte-thvrgb" list="motifs" id="motifs-input" onmouseover="focus()" autocomplete="false" value=""> 
			   <datalist id="motifs"></datalist>
			</div>
			<div class="space damage-info svelte-thvrgb"><b data-svelte-h="svelte-1tbnrpx">Damage:</b> 0</div>
			<div class="space damage-info svelte-thvrgb"><b data-svelte-h="svelte-dpwtxj">Damage with Modifiers:</b> 0</div>
			<div class="space damage-info svelte-thvrgb">
			   <div><b data-svelte-h="svelte-4ruqga">Damage against</b> <input style="width: 25px; margin: 0" class="svelte-thvrgb" value="35"> <b data-svelte-h="svelte-d8c6ri">% resists:</b></div>
			   0
			</div>
			<div class="space damage-info svelte-thvrgb"><b data-svelte-h="svelte-1ljfipn">DPS:</b> NaN</div>
		 </div>
		 <div class="grid-item weapon-stats-container svelte-thvrgb" style="grid-column: 1 / span 5">
			<div style="width: 100%; text-align: center; font-size: 18px"><b>undefined</b></div>
			<div class="weapon-stats svelte-thvrgb">
			   <div class="weapon-stat"><b data-svelte-h="svelte-b4f44p">Damage Type:</b> Slash</div>
			   <div class="weapon-stat"><b data-svelte-h="svelte-1tbnrpx">Damage:</b> 0</div>
			   <div class="weapon-stat"><b data-svelte-h="svelte-1s2gn6r">Penetration:</b> 0%</div>
			   <div class="weapon-stat"><b data-svelte-h="svelte-x5mixz">Range:</b> 0</div>
			   <div class="weapon-stat"><b data-svelte-h="svelte-j9i1yb">Swing Speed:</b> 0x</div>
			   <div class="weapon-stat"><b data-svelte-h="svelte-nxps6">Weight:</b> 0</div>
			   <div class="weapon-stat"><b data-svelte-h="svelte-74seyj">Endlag:</b> undefined</div>
			   <div class="weapon-stat"><b data-svelte-h="svelte-1vsnu34">Chip:</b> 0%</</div>
			</div>
			<hr>
			<div style="font-size: 13px; color: rgba(0, 0, 0, 0.5); text-align: center" data-svelte-h="svelte-lums63"><b>Scaling</b></div>
			<div class="weapon-stats svelte-thvrgb"></div>
		 </div>
		 <div class="grid-item weapon-stats-container svelte-thvrgb" style="grid-column: 1 / span 5">
			<div style="width: 100%; text-align: center; font-size: 15px" data-svelte-h="svelte-1ilm1wf"><b>PvE</b></div>
			<div><b data-svelte-h="svelte-1i6f4pv">DVM:</b> <input style="width: 25px; margin: 0" class="svelte-thvrgb" value="25">%</div>
			<div class="space damage-info svelte-thvrgb"><b data-svelte-h="svelte-1dhqoah">Max Damage against Monsters:</b> 0</div>
			<div class="space damage-info svelte-thvrgb">
			   <div><b data-svelte-h="svelte-1opikz0">Hits needed against</b> <input style="width: 50px; margin: 0" class="svelte-thvrgb" value="1000"> <b data-svelte-h="svelte-mc3v20">HP Monster:</b></div>
			   Infinity
			</div>
		 </div>
		 <div class="grid-item rings svelte-thvrgb" style="grid-column: 1 / span 1">
			<div style="text-align: center; margin-bottom: 10px" data-svelte-h="svelte-ind4x6"><b>Rings</b></div>
			<div class="ring-input space svelte-thvrgb"><b>Strength</b> <input type="checkbox" class="checkbox svelte-thvrgb"> </div>
			<div class="ring-input space svelte-thvrgb"><b>Agility</b> <input type="checkbox" class="checkbox svelte-thvrgb"> </div>
			<div class="ring-input space svelte-thvrgb"><b>Intelligence</b> <input type="checkbox" class="checkbox svelte-thvrgb"> </div>
			<div class="ring-input space svelte-thvrgb"><b>Willpower</b> <input type="checkbox" class="checkbox svelte-thvrgb"> </div>
			<div class="ring-input space svelte-thvrgb"><b>Charisma</b> <input type="checkbox" class="checkbox svelte-thvrgb"> </div>
			<div class="ring-input space svelte-thvrgb"><b>Isshin's Ring</b> <input type="checkbox" class="checkbox svelte-thvrgb"> </div>
			<div class="ring-input space svelte-thvrgb"><b>Ring of Casters</b> <input type="checkbox" class="checkbox svelte-thvrgb"> </div>
		 </div>
		 <div class="grid-item svelte-thvrgb" style="grid-column: 2 / span 4">
			<div style="text-align: center" data-svelte-h="svelte-14b4fxd"><b>Modifiers</b></div>
			<div style="margin: 10px 3px">
			   <div style="display: flex; justify-content: space-between">Damage Multipliers: <b>100%</b></div>
			   <div style="display: flex; justify-content: space-between">Total Penetration: <b>0%</b></div>
			</div>
			<span style="text-align: center; width: 100%; display: inline-block;">Normal</span> 
			<div class="ring-input disabled space svelte-thvrgb">
			   <div style="display: flex; justify-content: space-between; width: 100%"><b>Shade Devour</b> <i>25% DMG </i></div>
			   <input type="checkbox" class="checkbox svelte-thvrgb" disabled=""> 
			</div>
			<div class="ring-input disabled space svelte-thvrgb">
			   <div style="display: flex; justify-content: space-between; width: 100%"><b>Taunt</b> <i>10% DMG </i></div>
			   <input type="checkbox" class="checkbox svelte-thvrgb" disabled=""> 
			</div>
			<div class="ring-input disabled space svelte-thvrgb">
			   <div style="display: flex; justify-content: space-between; width: 100%"><b>Reinforce</b> <i>3% DMG </i></div>
			   <input type="checkbox" class="checkbox svelte-thvrgb" disabled=""> 
			</div>
			<div class="ring-input space svelte-thvrgb">
			   <div style="display: flex; justify-content: space-between; width: 100%"><b>Bullets</b> <i>10% PEN </i></div>
			   <input type="checkbox" class="checkbox svelte-thvrgb"> 
			</div>
			<span style="text-align: center; width: 100%; display: inline-block;">Unique</span> 
		 </div>
	  </div>
	  <div class="container svelte-1g04twj" id="Summary">
		 <div class="grid-item notes svelte-1g04twj">
			<p style="text-align: center; margin: 5px" class="svelte-1g04twj" data-svelte-h="svelte-aqumw2"><b class="svelte-1g04twj">Notes</b></p>
			<textarea id="summary-text" class="svelte-1g04twj"></textarea>
		 </div>
		 <div class="grid-item notes svelte-1g04twj">
			<p style="text-align: center; margin: 5px" class="svelte-1g04twj" data-svelte-h="svelte-19rrxj4"><b class="svelte-1g04twj">Stats</b></p>
		 </div>
	  </div>
   </div>
</div>
	<script>
	   {
		__sveltekit_12rqkzc = {
		 base: new URL(".", location).pathname.slice(0, -1)
		};
	   
		const element = document.currentScript.parentElement;
	   
		Promise.all([
		 import("_app/immutable/entry/start.DLM8dxvO.js"),
		 import("_app/immutable/entry/app.B6OY6F_z.js")
		]).then(([kit, app]) => {
		 kit.start(app, element, {
			 node_ids: [0, 4],
			 data: [null,null],
			 form: null,
			 error: null
		 });
		});
	   }
	</script>
 </div>
 </body>
 <script>
document.addEventListener('DOMContentLoaded', function() {
    const nonAttunementInputs = document.querySelectorAll('input.stat-input[stattype="base"]');
    const weaponInputs = document.querySelectorAll('input.stat-input[stattype="weapon"]');
    const attunementInputs = document.querySelectorAll('input.stat-input[stattype="attunement"]');
    const metaInputs = document.querySelectorAll('input.stat-input[stattype="meta"]'); // Meta stats
    const investmentPointsElement = document.querySelector('.points-info div:first-child');
    const pointsSpentElement = document.querySelector('.points-info div:last-child');
    const randomTextElement = document.getElementById('randomText');
    const powerElement = document.querySelector('.misc-stats div:nth-child(1)');
    const nextPowerElement = document.querySelector('.misc-stats div:nth-child(2)');

    const randomSentences = [
        "gimme... spec...", "Thank Envy! No... Mr. Aura...", "Cook dogshit and you're banned", 
        "Hey :3", "run my 1s mutt", "bakaa", "I love you", "I love you too", 
        "Valentina is the almighty (mutt)", "fuck this cheesy ass build, please remake it :(", 
        "sighh...", "u said wha??", "UPDATE STARKINDRED!!",
        "valentina will freshie gank you when u prog this build ingame (ggs bro)", 
        "Scrap this, make a quad attunement cheese :/", "So why arent you running silentheart heroism?!", 
        "Add gems :(", "Finish ironsing 😭✌💔", "this build is ass icl ts pmo🥀", "ggs", 
        "real original build you got there", "thwiggy is a closeted femboy", "YES we are all running every attunement", "AgentMk07 was here!!",
		"i likeee Super!!", "ryu coded some of this with his toes🥀", "What the hell is this?", "ok fine we can erp. - Ryu", "why dont YOU put a quote here, huh? yeah thats what i fucking thought"
    ];

    function getRandomSentence() {
        const randomIndex = Math.floor(Math.random() * randomSentences.length);
        return randomSentences[randomIndex];
    }

    function updateRandomSentence() {
        randomTextElement.textContent = getRandomSentence();
    }

    const totalBuildPoints = 505 - 105;
    const NON_ATTUNEMENT_FREE = 15;
    const HIGHEST_ATTUNEMENT_FREE = 10;
    const OTHER_ATTUNEMENT_FREE = 5;

    function calculateNonAttunementCost() {
        let allocated = 0;
        nonAttunementInputs.forEach(input => {
            allocated += parseInt(input.value) || 0;
        });
        return allocated > NON_ATTUNEMENT_FREE ? allocated - NON_ATTUNEMENT_FREE : 0;
    }

    function calculateWeaponCost() {
        let cost = 0;
        weaponInputs.forEach(input => {
            cost += parseInt(input.value) || 0;
        });
        return cost;
    }

    function calculateAttunementCost() {
        const values = [];
        attunementInputs.forEach(input => {
            values.push(parseInt(input.value) || 0);
        });
        if (values.length === 0) return 0;
        const maxValue = Math.max(...values);
        let cost = 0;
        attunementInputs.forEach(input => {
            let value = parseInt(input.value) || 0;
            let freeThreshold = OTHER_ATTUNEMENT_FREE;
            if (value === maxValue && value >= HIGHEST_ATTUNEMENT_FREE) {
                freeThreshold = HIGHEST_ATTUNEMENT_FREE;
            }
            if (value < freeThreshold) {
                cost += value;
            } else {
                cost += (value - freeThreshold);
            }
        });
        return cost;
    }

    function calculateMetaCost() {
        let cost = 0;

        // Handle meta input fields (select dropdowns, checkboxes, etc.)
        metaInputs.forEach(input => {
            if (input.type === 'checkbox') {
                cost += input.checked ? 1 : 0;  // If it's a checkbox, just check if it's selected
            } else if (input.type === 'select-one' || input.tagName === 'SELECT') {
                cost += parseInt(input.value) || 0;  // If it's a select dropdown, get the selected value
            } else {
                cost += parseInt(input.value) || 0; // Otherwise, pull from value directly
            }
        });

        return cost;
    }

    function updateStats() {
        const nonAttunementCost = calculateNonAttunementCost();
        const weaponCost = calculateWeaponCost();
        const attunementCost = calculateAttunementCost();
        const metaCost = calculateMetaCost();
        const totalCost = nonAttunementCost + weaponCost + attunementCost + metaCost;
        const remainingPoints = totalBuildPoints - totalCost;

        pointsSpentElement.innerHTML = `<b class="svelte-g2d5k9">Points Spent</b>: ${totalCost}`;
        investmentPointsElement.innerHTML = `<b class="svelte-g2d5k9">Points Remaining</b>: ${remainingPoints}`;

        // Power calculation: Based on points spent
        let powerLevel = Math.min(Math.floor(totalCost / (totalBuildPoints / 80)), 80); // scale to 80 max power level
        let nextPowerThreshold = (totalBuildPoints - totalCost) < (totalBuildPoints / 80) ? 'MAX' : `${(totalBuildPoints / 80) - (totalCost % (totalBuildPoints / 80))} points`;

        if (powerLevel >= 80) {
            nextPowerThreshold = 'MAX'; // Once we reach max power level
        }

        powerElement.innerHTML = `<b class="svelte-g2d5k9">Power:</b> ${powerLevel}`;
        nextPowerElement.innerHTML = `<b class="svelte-g2d5k9">Next Power:</b> ${nextPowerThreshold}`;
    }

    const allInputs = document.querySelectorAll('.stat-input');
    allInputs.forEach(input => {
        input.addEventListener('input', function() {
            let value = parseInt(this.value) || 0;
            if (value < 0) value = 0;
            else if (value > 100) value = 100;
            this.value = value;
            updateStats();
        });
    });

    // Heartbeat
    updateStats();
    setInterval(updateRandomSentence, 15000);
});

</script>
<script>
	document.addEventListener('keydown', function (event) {
		if (event.key.toLowerCase() === ']') { // Check if the 'L' key is pressed
			const videoContainer = document.getElementById('video-container');
			const video = document.getElementById('dolly-video');
			const audio1 = document.getElementById('audio1');
			const audio2 = document.getElementById('audio2');
	
			// Show the video container
			videoContainer.style.display = 'block';
	
			// Reset video and audio positions
			video.currentTime = 0;
			audio1.currentTime = 0;
			audio2.currentTime = 0;
			const randomTextElement = document.getElementById('randomText');
			randomTextElement.textContent = 'T̸͍̾́h̵͍̲́͝ĩ̵͖͖͐ş̵̘̓̄ ̶̲̏î̴͚͖̈s̶͇̀ ̴̱͖̇"̴͕̃H̵͔̠͐͗e̶̥͝ŕ̴͎"̴̜͓̌͘';
			// Play video
			video.play().then(() => {
				console.log('Video is playing');
	
				// Play Audio 1 at 19 frames (~0.32 sec at 60 FPS)
				setTimeout(() => {
					randomTextElement.textContent = 'T̸͍̾́h̵͍̲́͝ĩ̵͖͖͐ş̵̘̓̄ ̶̲̏î̴͚͖̈s̶͇̀ ̴̱͖̇"̴͕̃H̵͔̠͐͗e̶̥͝ŕ̴͎"̴̜͓̌͘';
					audio1.play();
					console.log('Audio 1 started at 19 frames (0.32 sec)');
				}, (19 / 60) * 1000);
	
				// Play Audio 2 at 80 frames (~1.33 sec at 60 FPS)
				setTimeout(() => {
					randomTextElement.textContent = 'Hahaha Haha...';
					audio2.play();
					console.log('Audio 2 started at 80 frames (1.33 sec)');
				}, (80 / 60) * 1000);
			}).catch(error => console.error('Error playing video:', error));
	
			// Hide video container when the video ends
			video.onended = () => {
				randomTextElement.textContent = 'Hahaha Haha...';
				videoContainer.style.display = 'none';
				audio1.pause();
				audio2.pause();
				console.log('Playback ended');
				randomTextElement.textContent = 'Bye bye...';
			};
		}
	});
	</script>
	
	<!-- Video Container -->
	<div id="video-container" style="position: fixed; bottom: -13%; left: -13%; width: 120%; height: auto; display: none; z-index: 9999; pointer-events: none; text-align: center; background: transparent;">
		<video id="dolly-video" style="width: 100%; height: auto;" muted>
			<source src="output.webm" type="video/webm">
			Your browser does not support the video tag.
		</video>
	</div>
	
	<!-- Hidden Audio Elements -->
	<audio id="audio1">
		<source src="Dolly_shock.mp3.mp3" type="audio/mpeg">
		Your browser does not support the audio tag.
	</audio>
	<audio id="audio2">
		<source src="Dolly_laugh.mp3.mp3" type="audio/mpeg">
		Your browser does not support the audio tag.
	</audio>
	<script>
		document.addEventListener('DOMContentLoaded', function () {
			const statsButton = document.querySelector('.tabs-button:nth-child(1)'); // Stats button
			const talentsButton = document.querySelector('.tabs-button:nth-child(2)'); // Talents button
			const statsContainer = document.getElementById('Stats'); // Stats container
			const talentsContainer = document.getElementById('Talents'); // Talents container
			const tabsContainer = document.querySelector('.tabs-container'); // Tabs container
		
			// Function to update the height of tabs-container
			function updateContainerHeight() {
				// Temporarily make both visible to measure their height
				statsContainer.style.visibility = 'visible';
				statsContainer.style.opacity = '0';
				talentsContainer.style.visibility = 'visible';
				talentsContainer.style.opacity = '0';
		
				const statsHeight = statsContainer.offsetHeight;
				const talentsHeight = talentsContainer.offsetHeight;
				const maxHeight = Math.max(statsHeight, talentsHeight);
		
				// Reset visibility and opacity based on the active tab
				if (statsButton.classList.contains('selected')) {
					statsContainer.style.visibility = 'visible';
					statsContainer.style.opacity = '1';
					talentsContainer.style.visibility = 'hidden';
					talentsContainer.style.opacity = '0';
				} else {
					statsContainer.style.visibility = 'hidden';
					statsContainer.style.opacity = '0';
					talentsContainer.style.visibility = 'visible';
					talentsContainer.style.opacity = '1';
				}
		
				// Set the tabs-container height to the tallest content
				tabsContainer.style.height = `${maxHeight}px`;
			}
		
			// Function to show Stats and hide Talents
			statsButton.addEventListener('click', function () {
				statsContainer.style.visibility = 'visible';
				statsContainer.style.opacity = '1';
				statsContainer.style.pointerEvents = 'auto';
		
				talentsContainer.style.visibility = 'hidden';
				talentsContainer.style.opacity = '0';
				talentsContainer.style.pointerEvents = 'none';
		
				statsButton.classList.add('selected');
				talentsButton.classList.remove('selected');
		
				updateContainerHeight();
			});
		
			// Function to show Talents and hide Stats
			talentsButton.addEventListener('click', function () {
				statsContainer.style.visibility = 'hidden';
				statsContainer.style.opacity = '0';
				statsContainer.style.pointerEvents = 'none';
		
				talentsContainer.style.visibility = 'visible';
				talentsContainer.style.opacity = '1';
				talentsContainer.style.pointerEvents = 'auto';
		
				talentsButton.classList.add('selected');
				statsButton.classList.remove('selected');
		
				updateContainerHeight();
			});
		
			// Initialize: Show Stats by default and set initial height
			statsContainer.style.visibility = 'visible';
			statsContainer.style.opacity = '1';
			statsContainer.style.pointerEvents = 'auto';
		
			talentsContainer.style.visibility = 'hidden';
			talentsContainer.style.opacity = '0';
			talentsContainer.style.pointerEvents = 'none';
		
			statsButton.classList.add('selected'); // Highlight Stats button by default
			updateContainerHeight();
		
			// Recalculate height on window resize
			window.addEventListener('resize', updateContainerHeight);
		});
		</script>

</html>	